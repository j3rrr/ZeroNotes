local _, ZN, L = ...

local ZBMImportString = "!WA:2!TVZwSTr21zAMnlk30gB5y3DZUj7SZg5LCffTiLLxhVrPvuIYMzLO0ss5xskud5CjNzf5mZoZq9WEDaIq(WaPbbRABsZ2IGcH(rrBAlQskksBakGrrqb6pxO2p0FfWF0pZhBBtBtFKEo37DgoKCOISCB(QuqKZCFCMZ986EoN7zIuFiLyd5uC8uJLAIHAnK6qQpmD2g2MBMDMfUvHhx10wLyNvP26Q2MwwNjBt97DpfBvPYMMnD1ToqPTRMP9cwU6MgoXS3EH61DiU34xDT34NCk4ZonS1vlVTfrU4m7vVDZMtRBxRjzTIowk1iptM22nTEznxxlNRDPlTPsdZu6MxA(TxKy7yAO0CMSZFPRARuJb9Ru0XvX2nwwDdD3yvRd)4OfBhxB9gnGXx4I2Il)gzDHNywL22kp2PDvYged3sTRxxFR9Rm9uLkxPu5PkwUiR9Q3GO00vROHslItSDCSinBMx1j2EQKQWuqu3(g5MBXzxAoFyTOnbGvXslMBU5Y2gqMQwnv2MyVhoJsAMBUGXJCy)mfG5Bq2TTHaZITVQUZ702G1CgLMnToRc76Y8(N3uL8Do1(1mB2ULrjKefTQTIQEBNVYhBN2oK50BPdiRst9ggvNoxHY5kMvL4u7X3LyBkL10XrcaHJnqOqWfXEdGWa0UZURIDT5ignC1(kxiBttf1FOTUbWMBBDHITAdCYyvDvAcRTlqhpwXAnvCCWRYc0JA4f7cp8kSM1Yc8dc2MDDoJH1V1gwDaWEQ6a1Uga3TzqX2SjFg8HKHdA97XA8GQcPRPnBAA)fIgn6IrbHrBfd9wkUeTIo1GzfDhBtxf8XfPkxOuBp(V5uBqSoBP3TTInrAwqet6wA6UK9SjnGrJmWhPUnWE1RXwVIzvcE6ptwhtB39qciXqfOh76qAwFrtDaflVWIfBIu7NdEWBYzf7Ryude2zdGoYJRbYKUkgUZcKbt7QfNAM8lvktBD19NOCrnR3D823AMp7J4poUAXRu1H0cyjftdQBJTNRznb)55Ju59L1vloM0DZo)UOoZT0vD1EU9RBdYLLCTvCvI(H8h)Syt4YQAPPlMlxb7Te6C)v)TFAuL7u7ZFK5nGgJufWY66nIz98GiJPnrOPMdLJZzBBA7S2hclhInOTDtoYm)EWCu15A0cGX5nrIej6UC(c05vO)sZspxwdtdYbQGUg2wfuZZ2HGqW5refhe5zYDp7o4DiEtjzBPOBaZLsO1PnOAplvhU8m92Yq1E9h(27bwkSxNrooF2gnn3u7axYwUPN1euQbM4e0vJqF2i0fOJCaBOf9KtOph9JLvhWK12Tom4zBQ0WXEHLkpx(c52dBVsnpjUO7IWmdctRZmRT(9KE72kQivxQCz6BrhzNQkcAquGgyDggkmnmCyH0ciLiClLFMC7X6GjHuSy(RFJYpIHtCo0DI8y)hddBOVln9pKMXxbZamVyRrVm2aDc23Vj77RY(Es23Fw23xH99NJ991yF)5XVTodaNPuFN2oUevI686gAuqGb4oWc4a)Nos4sBJ322MKfWfxoEwM3Iv88OibOFtwzAfhxq1iRI9klLF0o3nAjCcGrwxZ1O3cfGFed85muQ2KOQX5B(60rdsiUDK9QbyOzl85TvKHRZSiAAeVss(FO14eXKGp61LqSVcXydjfdv)BsbQEUejxnIbBC4NMMGLcjlBZgst2Zatr2YsNlIwwVfrAuPRtCXRINWF6WJIn3pV0yDdx8JnbimgsoUODZu1nTbDG4YdNQoaQHDKLsYMBsPoyo(H00HifgCWH1zugQX8(f)p8pwNTlXBCRIStTu5fOF0FcO4SpAfZwNPDVtDblUytf7gKSiFXkL0pJpJo6OSDrG9CHllUjQX9m30gKNkaiRg9Cv1ikGPa6x)02gMZtaiRrF)O1HoCnB0Ojbh6mawOLzDY2W(3TnuxWamEuxb2iqllUK3BryJsPsyx8Ps)nPFdn63e2WWb3dDQMnPFG1qZWVtc2Guczs2o0VLwxtyh0s9cgn3gg(zWTCLmHBKATn2oFW3KUlG00FDaFP)gydZs)AvBrGntBbn)Rr)6wV(sa3j3wfllvWeKLmbLpjgjGDlk5THIEtuCofF6fDAbOKy2ZhVSMUJul9gAUsnbsJKRPKHPRgiGivLGFlwveveyGifhWBQ4GJtYbSBGZbXGeDV6SapmYD7ILXvh6TbGy(45axDiA91O)UaQDTCO6lOVinvtD4PbpKMMMRlbITs6WMwiYAwxABZ22s10uqhSaASeYNzG(C0yhSHIToU0zwExd4946mkAM6gSlXN53GEUI6gwTDrS(9Js)wNM(nrNtuCOFqr2JgaaA8)87YCYOPUbrdbb3veT(weaaP)bDa2hy9PYZ21sQe6xMu(zCyRb05kjuw5B(i(UASUDO)rNN(hRr)t0ON9BFr6q)yqYKBMzF(pv00vjfDbbkv65PxWRvClR9zwjABPcFt)LPp)bnigeB9ACV5OY0xMkr)u0pn9tgJU)wpZB6BXcKhyt1HR0hRJDisaJqbAMPxaDvxbSnWv7t5deCkEx3R5Vu8DYxwwOzjVA3wP8aSRDBYBglODLE(cGjjfZvAMPWqmHwZSvvfEVt2XqjyPlW88Nsq7NKua1fK8DwgS4MFMv97Rp7PJokjfeiGID5sl1lrSRX8KGkDHo4huyz9KsBas9swk62oX7fdtiPAgRxtHWkzDPV0KsYGOAXYOsNCFJb3mQVg3y50Rkf6qrfEskn4syZXL3yaJIn)rLspM0NlitOVXIKtPbUQ7MzIE6a0osk7wlVXYzwDv2tQZTHovujJ0KuZn(4jrYotblVrDZ44CsKqAqZc7o0(cTrskK9hBqBj5lxKCGdbPyPsT(rnGXxDW9kZSgip4bKo9G7lOw0immz0Jy0Jn4Uqw0G71qVzsPb2ltT)Ow(xoC(rIbWqciIYTL0348mRe29bVw4QJpmeU3WJH2X6TYvy6fwcdHLhpEsPonKRWmjLwCUPUdCDXCxpxHkZKV0uzNlxVnNRaR1I10i1wVQW(9leJ(I0x6d5M3VPyFmhRN)(m0q1SKWsPCvtZMYXEa9vJbBxG79SpUVa9phS3J26)(0)cCVaWGFK18n4ZW(KWwrjLsLkvIUmRY7uAsa09S442p4Jg0scmWqxL8H3L)Uy(iAWbat7VF7Vb941UptM9pmW8hma4laHsFeGdt3s8GZkXrmyH4da47)GJusGn9oE7s)Zas93fyaV6fq69BFYP3GSthYhUeNuQFK)i4bcrQNewqpK0XoAwcOpFmPBD263FNsVwczlZbOV5rG)m0HTgse2fpBtZz2qVMvCFsTlhwEWbTKhmCe6f)oNY6tud0zun30adDd8tNhShvz(hhiWtwyNQ88d0Dm(VZdFXdCTvmCGqo5jdy)QS87SfZ1YkSR12vPPLMIOBwq6tfL)71JY7BwaN3ksvFuhd(YM44KuIrPtkPsA6Q0xiK9ZtzeXb0CpbnE8gvWqlHDXhVBxF6XrlfdiUjGN7J)sVUug4Fi4sTuw6OFoXfxlDjPm9XRzlwyVN4X5dZrh8ifHzcOX0jUuMeaWcqk8u8co9JiKtKPZzEhGmhFghZh(kmgXAC(sXOO1toRC7OiRUdBg5vNMNarCORvKnXf)iJLAI0dTvKH2oYUSo487D8sLugO)Dzae74aiYBfmUJsyl8jWfc(OHieyNoPud4)QW)kW)2zG7H)Rc)RK5PvSacQoDS(8QLZrTt2iz1GPFa2AhIR09g5UD8qatFCu28tMUF)396VRvwaExvw(rjr4KmK0y9Bpi1JBl(9oWV4OVT4374HobLpUnkFfq(moFkGOjV7ej8GwOd8oEd8ojckdYfBYgLEgiCZQq8UoexMfI)b6PrJfGy3h6Ly48gZABA4QvKLGj5HTESFgafPr7XoU61wF7zeIoAfzPkrdtTRIl2irJEPZUNt7Qfzzf25UBqp3UWT8SBEa)Nk8eSMbtvMOftw(QEorwC7KWqwkQfNosLn0D0bZGAICLwHO2GKTGPbXRbmv3VYfONBFrI4Qa))Wly9k4YOc7lEcLQyvb9hTcqoQPJPInYU(dbw280owXrtbma3jJSpM3QxQRPFvRZXAbtnhMP2ASq4ZofC7hYFy6Br4jy(lFaFjFhEE5IWsHxf0iUE9TPJShxMcn1NTWcfYrpNnqZWXWYZzV5pTcM3P9YTfYnD2uzBRHcGVIhXlDQUA928wJYsnzLnbY1TSvS25wIloWhSmJd)ibfiqE43pFHc4w3SCTY6uWnwZ6fcH8YVG(96aympzVGGmiWMiwV8G4mItsq7HFIdbkp9dLh2G(pX4c0)z6xL(Vq)X0)1Vm9Flc9FNoc9Nq)paRI)N0)lgjI(Ft)Phg5uV0PomYPpms0dJ8rO)OdJ8m7XxaZLB2YHGXgEym5Wi)cVWHrIf5Wip7A8NEid3XF4iQ58eGAUHGA7NF6fkuHFmtbF80F)XPvQt)T0O)oA0VTg93tJ(hEA6F6PP)DrFmtXlBtqjhtqzMPMzMEtjTYwA03)VEioRmtGCOxnFbmf6wNPtUHxI7q)pyxFfE6pTlhnaGTNix8EII7jGR39Y6Q7C3SZlLvX25aVJgHBqHwC)ns8ogoTM7lS5DENDzNjGJUkjlYn4WrCyp0FfFTEMvO0YdxJU2Amtu4XkzO6RpYg0(m6aptztsxIEt6hH(mIg1vvjgflK7M5kwSJge9UrPltxH(lcUnDXISO6SUwN0WpLQky2ALBruwFkWiIZklAUjXMD58evDLvyb14Ssnf3mPmB0yhvZkmGOr)4xe8O(L3nKSsn6t0hC49glyPCLxAXWtM8tk0JfZp3mCVGJbqqAQQvTjBOZmRls(hMkc(X16VH60ZWMtm(JE5p7vhBSRIXVkpNUX6IO7J9aeGLSatRaD4TiBJwBcadhEp5XJ1ZhyllFDItBhzeytm(vFJlprsr78ZnErtxENx(kJpXLVk(m6kUjaGG9fWT(7hShwGeE5aeqyjWpE8yvI9uYrMzbPcluwQ8cln9n(FdocMKOaKcN1B3SjB1k3rWCfi82RNRC(cxF2ItnFUvWtjQOIUAz8OhWffsqRCv5K46Kbbb0QzB64CYG2BWHgdcE4g78FpzG7kcKJbcb8AzAACYG2eCOHaqalxBDMt5Nm4Dzo88aIaMGkFltd1tgihNdsbm84hSkZ4KbWmcgcdeECeWPVtg0slZyhW8r9jHF1m)2aO5BbmfVjNL7OWPUQOXa6AEHKhEK2DAgIUg1i7lV(8upG2B4hXh6ic)Q08FYWC)T26Wiz5XtsCSQjfPMRtAl8H5Y5Nz1GP6NDpyA7(p4ndEsbSt4SNHXhapac2XGemH)8MRbRWge1q6b9ie2(Hesx4ceZnb(dGjYYb70ZPECTddYJmWYDcpbQSWK8UgNpor9ADbLnuA22B6PzjDkyVEH9nWb4c(I2u0BM(6TNGWh0W4CkOBXf92Viz5SFW(g)YxESX6cl4mxKckUcxTbKWz7Fa)u4MvMx3PwL3UnAB30yEyR)UihDYdjto5n9ckvK3D5xvMl60)5rZogpyEPt23y75WmeNaalzNGkMCQu6H0p0dIfCyPlfqI1pjZigVmOFHIJ2ng8jxhsyVb1Q0iBXbmCb0EdiAcSTKs4kqw2pWCXXSdUrYMckOnUu)HClct1)(4UMgTBvLyhxESTGfRamEpL0jtNatis63iXLYmXejpUZltYmNO5nEYXdoVyEveGE94HSaVsIbUcp(lqarFsXXl)KoLjsEfXugeVxKTYqTNY5XOiCLUoyUodiOq8gEg5yUk9MbApmRC9JkOpybrdV8)o6Oy6JdZvn0iBcw6DfsxEY4WeY7aUHVGXCMkqGmXLXJKxwW1q7FvUEQBITLcpXWuy8lOvmw3(7Avszd4zilQmaW)NLLXGtksQr0bfg8(BnvfOPkLZD7YYRoO8mHwFKMuwwk0ZH9e)4yRdKG2)j2IpXjF6wh9EcrdKK2vs38o3BVIIqGLHrT)sifP7CZ7J6Hm(qrQEtOht8lDpT2A7c8nmxcKCWlJlZRbu5e9nsEnymz)liwLsiZ25x(E37EYbPl(tZFfjAzs2q7cJfw55vcbtxnSNwWkLq8qLdfeZP742vbuz1uNNq7GpIKGb7eCNw6N0fQqjEe4iN4ATuCRPfxE47RREnW8s(zsLsE4haqlm1UUoheVZUN7)uGNmApbRUe0Ec7z0G)qETL)IRyVIXQJ8A9T3iGr4m6GnO3lxtUNJ2gL0IhpWa5C(bFa4bhR8uq8sj8p))(RKdrrmbSJWosDaA9nLofkL8QHnH4cXKVKqobF2DH9SEt07JRpT9qpYEHgbgty3KU4lpSYQJMazIdysiXnVrjsTGswyJLnHgJhcNi(YFXhS6imyoiGYYEsjGi2dcfF4T68xcqetW0cRqpqgth4WlSINa4YjN9DM49GJa76ibfxozaqa2zSmZAFxa49a6Z7zde9pJCORRJsyRhHcHyAOYaI4weiqWJUCqLdWri5ugpTWUvCh4m8t1d49kOuZq3gbvbbJgPgD47ZgtqHLWkONabvHdNV5PuW0hTSVppIhAIvduemP7Piy8gt4frHqQ6i1Dhm1MPoYk6qDdhWf64mQ2GRWd8Z97OFL0JQLSZAnPVa9dgqzFecpmS2osMctv4)NR8ZFUYXs9)4Tmrgml3QS6TShwCaolJXEu81auCF41ZoOhjTUhzdwiS9ci5qKZoga0eEW2f6KVJUbzBWS6QJCSa0ppKA7qlJ7J3hdshlO9aON)Cb9tPrLWG6869iHtyIB)mRQVJvN9Qowx3qnEhhqtkila(kFmxVpPQNhx1u5zzFKFqI)VHunOj(uP(l2Y233ZoX6Ifb9BTz3HyXBJ5w9aAFzbex9iygXEA5k3paJa8YmO)VbpDgFCjP4IK(ozbtPJZByiocEN0dsegcESiN8IioqQkyRIbA5lSGvwgIIC1j3i0XZdWe)EKaHzECk2YUW2GPIRVY3lqUn8QQZUZtIVN4btwc2OOC3GRMY2wz7WJle7oP81K7U(X8mc6p5LtVAIx)kJnsi9Kz1e9Gr(qpigzjI9uYArfx8LwlrSW8UeZVdEsy5UMuBhI09Xu6o2dqg4CTvgDIuJfyw1TuqdKYXtnAczPuP8bDGX0uXXfqkv)ebiS)NuIKuQMIfMUzoMDnMzmeMjLef3ZMA6aA5euCbZWjwF5SKCJZhR1C5qs5s)6oWOteAAlcGJKr6ih9Zah9Mv3LhggASh4(Ctk9QIj2nc2nmXKd2nWgWcqYFf0tXOX6UhHaHTk)JGmnlS)LLxNSTSNK8ds21PUIlUGImnXntK0DjTcu7OI0pwRTTnwdOGGHox1ghDIEyvEJAYjzGzGVByDvS09Qokgd)eFfL(6UQMv416WA0ZCXdJCrRX76a)xORd8VRJ5FkD7ByABGN0)HrIRXQ8L0Ix9U1agc(ELswJ)crodViOiA7BARdle2PKS3nwOy(7UqHYtnhT6N8I0)YRqhk6oEV0p2IdNOi7mBIAZt2QZNeqYXVYESZRG9AZKfFFUae)WiV2b8wXrAqAwDEqwGyVJLTPfW7XXSJxLJUw27zA2kYdh22STl6Fj9DPRgzFHdQO98ttF4wr(aFwyFVAn96ZfBRUU24I1sNuCfZplG8KdHsRYEopoS6ijEGCs)5E9slLTcUrtIWNMUQyoRySIb7ylgD08ZW2L17Sf3M4g6CFV3Rgmb4RedOBBSB7b0DFjgjP8WPL7KqD9jtN8QbfEf0PGiVTlEiqGxvbxX2UOlxlRVAOkM(oj6xZ2h0tjDHV8Thg580FWJ7UMZO)yw5SeJ(XbjKxFnSWUVZ0vMwtXf98nfwlEOucR2wMN44O0GWF36J)A3nxXfql4VwIyXeUkE8Z9Chv0J)CWk0GxnLN4CCp5txA3p5ZMjOtptm6zlCr6q)q)xKb8LxaFrg(U0Vh)fxlYFJNsLKxH1BXi48tToPKq9nj(YjQsS9pqo(OMCszp(sp7wHVFJO06KYfiBYEHP63m5jNUklhM92oVbDDoynpSygtdIhMC8SxhewpDy7jEMPs1v8y9Tm9pEl4l63)XtFJPkxz(sxVYuZmZcfyVafVqm2lQ4lsFj6RgJ(zYOySnRQ9FXagx7VyiPkZtFl7YlSiw2BzXIIK6s)hJrtFfXRz(eDEbZPFTZFq3LU5(bwdNMol9RVxN6l9R8XSE1qF0DxMRrPF0y2IQo9WiFA(RtUSU6JcsUSELbdjVYY0Ri6E2i0I7)Ukx)DDDMF67UzRdJmmVi7QeB)ElFwA1y74v4Phc3259wGxgY83BH(A5m92YqB83F7)N)"
local ZBMWagoUrl = "https://wago.io/ssH2QdjlK"
local ZNDImportString = "!WA:2!fJXsZTTXzrXjTny6dB5ANAh3weylzsBkwkPkzBvZMWxsM28HcjKKFiBiqGfeWccazbOEz72u1oD8m9u9T2J6CoPFbD8HEEhn9qp7z6LEQt(f0VDbijiPysSu7eEGyXU47B)E)kYkJ5wBMKPso7yBoM6yQV6Yh1qwzdvSTtoBtB89Ign6srHJFBdBSkcNn4qNZK10yV9KXQ8I22MEgohj3Yt3gx1XZW2YLRH)3RFG)ZcQnroNT(N1sgJ4xOLPj)Q6gEOdWOMWNlURdQwtSDlNGpVUXEO37q)1(0rKirIEGNTYwiSlaXpjI0FgVtvnnxK3D)B)j7rxEKrgblRWU85Q56jJ94AOzyz4QZLfE4XTVh2Ozta8lnboy5F8avuJwAA07hF3cLwAHLlL1JsmYTWYtVVRdY0SOQl3BDB1aTfYYRo81g7COuUm1fLQlMPMyNJwcJGJQvFPcLkLTfCJnCmL3fHRXoTXDrYME61SK3e5Y96wwbKahE3aU4tu(p)RpFKrg9n(ST)UV)HYwkGyDjBdah5kurSqTxlBzSPmLtNJCMfEds2fv3dJSA6P)DjFqwlBl0rQa9t)cjk3GDrk2wQU7t)ukVsUE2nLnSwGehaGCDYnijitcppB)7iyO6CXu8pQsE(j5FecBZxX2dXN3WLYBnaSQz0K7qnmWvani7jh9l9j4fOBrVRg1ZvRqHk1CvKnrrNULH6H37bg38Z2EHYAl04lb2cHTKnxXxVw(aqCwJzuasjxKPgJZpiBvrXQLlvybXdOSIHVrwwtBz15YcQjLluBZwGzixnftzx3lq(1CzDbJi6Ia7OIwG8m6ykx)vxfS08mnSaH8YILkwPWHQ(mKiAhpHXvoqPLRN9M032z0hQ1YIzwflohp8Z0gyeEp4m(08ccS9m04xfjVrgqO7wxElK6JfcWORWtESav8vdPGmaJxHNWlBPYZa7Bompwy1msWwsIfEGiGcpDKfdf0Fb0YjgBmeHSuzp5AJX00)MVjOoIj8CMJW8Xgx9gXFPqcQZHeYARKlwF5Ssfbfs8Jhmd1aywZAnRbGlF8jNSyEElBpEDqMyIu53f5DSy6fVqriHa8x8HCmMEmEihp(Z9m2enFSh)0x(KBeF8b4ar4uFi1SX8gPNkXT4vT7x(gMXWEcjtAKmPqyCH9kz469yJNeVhjkg51cBXaVReMdoLC1ioFuilpj42b)Ajhjk5kPUleRWqr35mDnhx2rv2dczXE8wiIRnnqGYQgQE6zZaVs(rqmboYz5iJnXRvTL8bD9g(p357nshQLg5RzAnztxehxF8qA(NZOsHxiwK6FQjRGwBnrzCtKNHvtMV9ARTCXjRjBO2zBQHG0uZN6fEcjoPGp9Pd8zoDG)lpDGp7Pd85oDGFZth43ka8xgYAOUU92P9WTqD3ILzL6WK2YWS72OI5tNQ7RwSxHFTdEYpymJy(zxZ77Te8c1pZ2Q1Mnq4EppuSx2(uVHwqTeP5HKeifVyZKyrKxDgiwA2Daoe27cciEa)3y9Sl45lesMrPqx4rLvKkxSEoPpD5c1flwTs5m1UVqCWZF(PMdKxDPTa38W4K6KpCrq(yT5TEeBDy)E48aSd5By4CYjhuHWp5KuvsOJaLcSzQHscuOI51tAnyNIw1rkUGukv7CBUqTkwntcvtPgZlHW8cX7lbuyO6Q(8HccqPOtbJLjGclvsNsibqSX5Vo)CP4VXWbYp)rVa5hDLg36DJaE6qXv4CFa)EmYwAo7y9ONs3JygqzVrwzq0J7r6P6tS5lYrMYoUi10G1ltFe)yuTdHr78YKbizqjtGDtxpA)kbfTZb3(gX6IIJxs0987KQxIVTb5lu00MD2z1MtovQ5tLcYb))oIyiUp9bUHvWgHnKdQ4nS5qFFxhJ7GV8oGb)XZImg7yyl)BAtdl6102hHLchk5i10j1esWdVONuZ02gmh9VOFXCPcck1d1(oHdOyC21E9EWva9spHgFcIWrXBhrktAYro3tNG8JF152VDhcJn1rnrqPWgk0O9vTERl7roORov7TTicqz40yAvGuhrGEdk7C2wUiPEGzDCllwxozPLKq(zKF(H(fCWA)Obyh71YLW7CX2yLFjSDtmY1LpglKDCYLiF4ryOfP6DURJOxtNREDYf5iNNCHAk6iLnifb6iwhtJGsZhWodiokB)AkMGUtu2yDYLj)uYv4arWFNYlKvi8KQJnfH)GC2B2q2JVKDtk9tVk)26CDUFHk5QUmTZl)o(sW3DJcvYNGFPszEiSUwHflurkFX6zYwQq)BxOcBxIynQ5Uk5sJsU8OKY7e570P)c21LGViaAYKj71k1)q(0qUR(OgHo6FwmQI5)nqGgFGHGsHG7yPsFO7jwfl8vqH0G7aFx8pyyX08DcBn4NHyPZ9doov)wPSQkczA22Gr3qfb6LRCbqb)Vp5IgqV0L1O0r6EORVw5tG66ejE857uF1YnAQ6WSp0hWZyC7wOPLT215SYS1I(tjOSTk6lgX5dp2Uf8xqKj3Sm52yXQlrBtoRMTLNZzwaBSh)N2swL2BoVOi5wCK7S1(mxlO9yDMRb13fRFiDje)HoggDCWcO)5jiCRNfd1lUo5JPTttsZ()tG)xPMdWr7U(0EiR1pWBBquURgq1R3WF967RzI2XOHjcwb0dDSoN)ixDzigWd8hWruY7NL2Ae5xX5CLH3mKdgPyqhqqusm6up6FYfj)6NLb5hgb)mWiZqB3Suje5hqhIKGH6H0UJdgPraX9qFI7YJqMkkzAYmKuCKzpmgEr3zvMjM6CI7VTnwDvSSZ(RgSOMs75Lf9qFKeAWvAg7GuzDP9h((KjixJ8ECVACswsoGOi5hLuyNi)1(MZWGdBOJDev(0RrjBhAznc)FVjEbHV9ABxy8Pe(2Or9xcgclQtUlK25EK7h0J9ytqkTonc(FjNuoDzpABhjPJUYfAIiJQQTvzibNCtK)GbJDThvOw1kvflCT4HAXIQ5slmKbSjWXbb4Os63HXl1PgMV5WK(5VmO8Gt8qKsFYhMf1s(Kdn1QFyIp6CqoxLoj7HAmG09FeRgafiEjO7(NDRHiihJdtBLGzgKGxbmXTqMjGs0Sur44Tt64)vPbnxGsvO3AhP1ot1SPfQG2Mst9D(PA8FPfe6brbgU(ZYP9M0sv7sf5TTqTPKbiK(tjpqLUNoQ9edzYKD8f)Qz1ah4Wnoqlxu6T5UBgrPY1xukt(8vRWQ2tGRD9DqDGeerJ08lgHO7N(0p3cnPbK7iuUL(25SdSZZiBWsToxq2XpUtosoYwNNSnKMJSd53s(CYUrHG)SCa)EixWEKN3jp0Bclmi)o)ujHeioFWqSZ7MH6w3UYm7D78AvwPb5Qri7ZY(aPwPPXUnXyST(hp4)("
local ZNDWagoUrl = "https://wago.io/LjFE8wNMN"

local selectedTemplate = nil

ImpExpSidebar = ZNSidebarFrame.Subframes.ImpExp
ImpExpContent = ZNBodyFrame.Subframes.ImpExp

ImpExpSidebar.ImpExpPlayerDbButton = ZN.CreateGenericButton("ImpExpPlayerDbButton", ImpExpSidebar, "TOPLEFT", ImpExpSidebar, "TOPLEFT", 240, 30, 0, -30,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Playerspell DB", "CENTER",true )
ImpExpSidebar.ImpExpBossTemplateButton = ZN.CreateGenericButton("ImpExpBossTemplateButton", ImpExpSidebar, "TOPLEFT", ImpExpSidebar.ImpExpPlayerDbButton, "BOTTOMLEFT", 240, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Boss Templates", "CENTER",true )
ImpExpSidebar.ImpExpGroupTemplateButton = ZN.CreateGenericButton("ImpExpBossTemplateButton", ImpExpSidebar, "TOPLEFT", ImpExpSidebar.ImpExpBossTemplateButton, "BOTTOMLEFT", 240, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Group Templates", "CENTER",true )
ImpExpSidebar.ImpExpBossWeakaurasButton = ZN.CreateGenericButton("ImpExpBossWeakaurasButton", ImpExpSidebar, "TOPLEFT", ImpExpSidebar.ImpExpGroupTemplateButton, "BOTTOMLEFT", 240, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Weakauras", "CENTER",true )

ImpExpContent.ImpExpInfoSubframe = ZN.createSubFrame("ImpExpInfoSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","HIGH", false, 0, 0)
ImpExpContent.PlayerDbSubframe = ZN.createSubFrame("PlayerDbSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
ImpExpContent.BossTemplateSubframe = ZN.createSubFrame("BossTemplateSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
ImpExpContent.GroupTemplateSubframe = ZN.createSubFrame("GroupTemplateSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
ImpExpContent.WeakaurasSubframe = ZN.createSubFrame("WeakaurasSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)

ImpExpSidebar.ImpExpPlayerDbButton:SetScript("OnClick", function(self) ZN:ToggleImpExpView("ImpExpContent.PlayerDbSubframe") end)
ImpExpSidebar.ImpExpBossTemplateButton:SetScript("OnClick", function(self) ZN:ToggleImpExpView("ImpExpContent.BossTemplateSubframe") end)
ImpExpSidebar.ImpExpGroupTemplateButton:SetScript("OnClick", function(self) ZN:ToggleImpExpView("ImpExpContent.GroupTemplateSubframe") end)
ImpExpSidebar.ImpExpBossWeakaurasButton:SetScript("OnClick", function(self) ZN:ToggleImpExpView("ImpExpContent.WeakaurasSubframe") end)
--[[ ##############################################################################
  Imp / Exp Info
############################################################################## --]]
ImpExpInfoSubframe = ImpExpContent.ImpExpInfoSubframe
ImpExpInfoSubframe.UrlButton = ZN.CreateGenericButton("HomeUrlButton", ImpExpInfoSubframe, "BOTTOM", ImpExpInfoSubframe, "BOTTOM", 640, 30, 0, 0,0,0, 10, ZN.Colors.INACTIVE, ZN.Colors.BG, nil, "www.zero-wow.de", "CENTER",false )
ImpExpInfoSubframe.UrlButton:SetScript("OnClick", function(self) ZN:ToggleInfo(self) end)
ImpExpInfoSubframe.MainTitle = ZN.CreateText(ImpExpInfoSubframe, "TOP", ImpExpInfoSubframe, "TOP", 680, 30, 0, -30, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNVers.ttf", 18, ZN.Colors.ACTIVE, "Import / Export", "LEFT", "TOP")
ImpExpInfoSubframe.MainIntro = ZN.CreateText(ImpExpInfoSubframe, "TOP", ImpExpInfoSubframe.MainTitle, "BOTTOM", 680, 300, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNTitle.ttf", 14, ZN.Colors.ACTIVE, 
"Here you can import Boss Templates and Spell Setups or export yours to share with others.\n\n"
.."|cff"..ZN.Colors.chatYell.."Warning:|r Importing a new Playerspell DB will override your current DB!\n\n"
.."If you want to extend the usage of your notes or you / member of your raid don't use ExRT have a look at the Weakauras Tab."
, "LEFT", "TOP",8)
--[[ ##############################################################################
  Player DB Imp / Exp
############################################################################## --]]
PlayerDbSubframe = ImpExpContent.PlayerDbSubframe
PlayerDbSubframe.EditBox = ZN.MultiLineEditBox("PlayerDbEditBox", PlayerDbSubframe, "TOP", PlayerDbSubframe, "TOP", 660, 450, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
PlayerDbSubframe.PlayerDbImportButton = ZN.CreateGenericButton("PlayerDbImportButton", PlayerDbSubframe, "BOTTOMRIGHT", PlayerDbSubframe.EditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Import Spell DB", "CENTER",true )
PlayerDbSubframe.PlayerDbExportButton = ZN.CreateGenericButton("PlayerDbExportButton", PlayerDbSubframe, "RIGHT", PlayerDbSubframe.PlayerDbImportButton, "LEFT", 200, 30, -10, 0,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Export Spell DB", "CENTER",true )
--Import Player DB Confirmation
ZNPlayerImportConfirmFrame = ZN.createSubFrame("ZNPlayerImportConfirmFrame",ZNFrame, 302, 202, ZN.Colors.ROWBG, 1, 'CENTER', 'TOOLTIP', true)
ZNPlayerImportConfirmFrame:SetScript("OnMouseDown", function(self, button)end)
table.insert(ZN.DropDownsEdit, ZNPlayerImportConfirmFrame)
ZNPlayerImportConfirmFrame:SetBackdrop({bgFile = "Interface/Tooltips/UI-Tooltip-Background", 
  edgeFile = [[Interface\Buttons\WHITE8x8]],
  edgeSize = 1,
});
ZNPlayerImportConfirmFrame:SetBackdropColor(tonumber("0x"..ZN.Colors.HD:sub(1,2))/255, tonumber("0x"..ZN.Colors.HD:sub(3,4))/255, tonumber("0x"..ZN.Colors.HD:sub(5,6))/255, 1);
ZNPlayerImportConfirmFrame:SetBackdropBorderColor(tonumber("0x"..ZN.Colors.INACTIVE:sub(1,2))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(3,4))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(5,6))/255, 1);

ZNPlayerImportConfirmFrame.btnClose = ZN.CreateIconButton(ZNPlayerImportConfirmFrame, "TOPRIGHT", ZNPlayerImportConfirmFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
ZNPlayerImportConfirmFrame.Title = ZN.CreateText(ZNPlayerImportConfirmFrame, "TOP", ZNPlayerImportConfirmFrame, "TOP", 150, 30, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNReg.ttf", 14, ZN.Colors.ACTIVE, "IMPORT PLAYER DB")
ZNPlayerImportConfirmFrame.Message = ZN.CreateText(ZNPlayerImportConfirmFrame, "TOP", ZNPlayerImportConfirmFrame, "TOP", 260, 60, 0, -40, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNReg.ttf", 12, ZN.Colors.ACTIVE, "Importing will override your local Database\nAre you sure?", "CENTER")
ZNPlayerImportConfirmFrame.ConfirmButton = ZN.CreateGenericButton("ZNImportPlayerConfirmButton", ZNPlayerImportConfirmFrame, "BOTTOMLEFT", ZNPlayerImportConfirmFrame, "BOTTOMLEFT", 125, 30, 20, 20,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Confirm", "CENTER",true, ZN.Colors.HD )
ZNPlayerImportConfirmFrame.CancelButton = ZN.CreateGenericButton("ZNImportPlayerCancelButton", ZNPlayerImportConfirmFrame, "BOTTOMRIGHT", ZNPlayerImportConfirmFrame, "BOTTOMRIGHT", 125, 30, -20, 20,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Cancel", "CENTER",true, ZN.Colors.HD )

ZNPlayerImportConfirmFrame.btnClose:SetScript("OnClick", function(self) ZNPlayerImportConfirmFrame:Hide() end)
ZNPlayerImportConfirmFrame.CancelButton:SetScript("OnClick", function(self) ZNPlayerImportConfirmFrame:Hide() end)
-- Import
ZNPlayerImportConfirmFrame.ConfirmButton:SetScript("OnClick", function(self) 
  local str = PlayerDbSubframe.EditBox.editbox:GetText() 
  if not str or str == "" then
    UIErrorsFrame:AddMessage("Insert Import String", 0.8, 0.07, 0.2, 5.0)
    return
  end
  local decstr = ZN:dec(str)
  ZNotes.PlayerSpells = loadstring(decstr)()  
  ZN:ReloadPlayerTable()
  ZN:Print("Imported Player DB")
  ZNPlayerImportConfirmFrame:Hide()
end)
-- Export
-- https://stackoverflow.com/questions/6075262/lua-table-tostringtablename-and-table-fromstringstringtable-functions
PlayerDbSubframe.PlayerDbExportButton:SetScript("OnClick", function(self) 
  local str = ZN:serializeTable(ZNotes.PlayerSpells, nil, true) 
  
  PlayerDbSubframe.EditBox.editbox:SetText(ZN:enc(str)) 
end)

PlayerDbSubframe.PlayerDbImportButton:SetScript("OnClick", function(self) 
  ZNPlayerImportConfirmFrame:SetShown(not ZNPlayerImportConfirmFrame:IsShown());
end)
--[[ ##############################################################################
  Boss Template Imp / Exp
############################################################################## --]]
-- Import
BossTemplateSubframe.ImportEditBox = ZN.MultiLineEditBox("TemplateImportEditBox", BossTemplateSubframe, "BOTTOM", BossTemplateSubframe, "BOTTOM", 660, 180, 0, 15, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
BossTemplateSubframe.ImportNameTextBox = ZN.SingleLineEditBox("ImportNameTextBox", BossTemplateSubframe, "BOTTOMLEFT", BossTemplateSubframe.ImportEditBox, "TOPLEFT", 400, 30, 0, 10, 10, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Enter Template Name", "LEFT")
BossTemplateSubframe.TemplateImportButton = ZN.CreateGenericButton("TemplateImportButton", BossTemplateSubframe, "BOTTOMRIGHT", BossTemplateSubframe.ImportEditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Import", "CENTER",true )

BossTemplateSubframe.TemplateImportButton:SetScript("OnClick", function(self) 
  local newTemplateName = BossTemplateSubframe.ImportNameTextBox:GetText()
  local encstr = BossTemplateSubframe.ImportEditBox.editbox:GetText()
  local decstr = ZN:dec(encstr)

  if newTemplateName == "Enter Template Name" or newTemplateName == "" then
    UIErrorsFrame:AddMessage("Please Enter a Name for your Template", 0.8, 0.07, 0.2, 5.0)    
    return
  end
  if encstr == "" then
    UIErrorsFrame:AddMessage("You need to insert an import string", 0.8, 0.07, 0.2, 5.0)
    return
  end

  ZNotes.BossTemplates[newTemplateName] = loadstring(decstr)()

  BossTemplateSubframe.ImportEditBox.editbox:SetText("|cff"..ZN.Colors.itemUncommon.."Template successfully imported as|r |cff"..ZN.Colors.chatInstance.."'"..newTemplateName.."'|r")
end)
-- Export
BossTemplateSubframe = ImpExpContent.BossTemplateSubframe
BossTemplateSubframe.ExportEditBox = ZN.MultiLineEditBox("TemplateExportEditBox", BossTemplateSubframe, "TOP", BossTemplateSubframe, "TOP", 660, 180, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
BossTemplateSubframe.TemplateSelectButton = ZN.CreateGenericButton("ZNBossTemplateSelectButton", BossTemplateSubframe, "BOTTOMLEFT", BossTemplateSubframe.ExportEditBox, "TOPLEFT", 240, 30, 0, 10,10,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Select Boss Template..", "LEFT",true )
BossTemplateSubframe.TemplateSelectButton.doOnUpdate = true
BossTemplateSubframe.TemplateSelectButton.OnUpdate = function(_,_,_,newValue) selectedTemplate = newValue end
BossTemplateSubframe.TemplateExportButton = ZN.CreateGenericButton("TemplateExportButton", BossTemplateSubframe, "BOTTOMRIGHT", BossTemplateSubframe.ExportEditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Export", "CENTER",true )

BossTemplateSubframe.TemplateSelectButton:SetScript("OnClick", function(self) ZN:CreateDropdown(self, ZN:getTableKeys(ZNotes.BossTemplates), ZN:getTableOrder(ZNotes.BossTemplates), 240, ZN.Colors.INACTIVE, "LEFT", 10) end)
BossTemplateSubframe.TemplateExportButton:SetScript("OnClick", function(self) 
  if selectedTemplate == nil or selectedTemplate == "Select Boss Template.." then
    ZN:Print("You need to select a Boss Template")
    return
  end
  local str = ZN:serializeTable(ZNotes.BossTemplates[selectedTemplate], nil, true) 
  
  BossTemplateSubframe.ExportEditBox.editbox:SetText(ZN:enc(str)) 
end)
--[[ ##############################################################################
  Weakauras
############################################################################## --]]
WeakaurasSubframe = ImpExpContent.WeakaurasSubframe
WeakaurasSubframe.Title = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe, "TOPLEFT", 680, 30, 0, -30, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNVers.ttf", 18, ZN.Colors.ACTIVE, "Zero Weakauras", "LEFT", "TOP")
WeakaurasSubframe.IntroText = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.Title, "BOTTOMLEFT", 680, 50, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNTitle.ttf", 14, ZN.Colors.ACTIVE,
"There are two Weakauras to supplement ZeroNotes."
, "LEFT", "TOP", 8)
-- ZBM
WeakaurasSubframe.ZBMTitle = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.IntroText, "BOTTOMLEFT", 680, 30, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNReg.ttf", 18, ZN.Colors.ACTIVE, "ZBM - Zero Boss Mods", "LEFT", "TOP")
WeakaurasSubframe.ZBMText = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZBMTitle, "BOTTOMLEFT", 680, 100, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNTitle.ttf", 14, ZN.Colors.ACTIVE,
"The ZBM Weakaura will show bossmod-like bars for your note. You can choose whether you want to have bars for every assigned cooldown or only your own.\n\n"
.."Please visit wago.io for further information"
, "LEFT", "TOP", 8)
WeakaurasSubframe.ZBMImportStringButton = ZN.CreateGenericButton("ZBMImportStringButton", WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZBMText, "BOTTOMLEFT", 200, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "WA Import String", "CENTER",true )
WeakaurasSubframe.ZBMWagoButton = ZN.CreateGenericButton("ZBMWagoButton", WeakaurasSubframe, "LEFT", WeakaurasSubframe.ZBMImportStringButton, "RIGHT", 200, 30, 10, 0,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "wago.io", "CENTER",true )
-- ZBM Import Frame
WeakaurasSubframe.ZBMImportStringFrame = ZN.createSubFrame("ZBMImportStringFrame", WeakaurasSubframe, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
WeakaurasSubframe.ZBMImportStringFrame.btnClose = ZN.CreateIconButton(WeakaurasSubframe.ZBMImportStringFrame, "TOPRIGHT", WeakaurasSubframe.ZBMImportStringFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
WeakaurasSubframe.ZBMImportStringFrame.editbox = ZN.MultiLineEditBox("ZBMImportEditBoxFrame", WeakaurasSubframe.ZBMImportStringFrame, "TOP", WeakaurasSubframe.ZBMImportStringFrame, "TOP", 680, 450, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, ZBMImportString, "LEFT")
-- ZBM Wago Url Frame
ZBMWagoUrlFrame = ZN.createSubFrame("ZBMWagoUrlFrame",ZNFrame, 302, 152, ZN.Colors.ROWBG, 1, 'CENTER', 'TOOLTIP', true)
ZBMWagoUrlFrame:SetScript("OnMouseDown", function(self, button)end)
table.insert(ZN.DropDownsEdit, ZBMWagoUrlFrame)
ZBMWagoUrlFrame:SetBackdrop({bgFile = "Interface/Tooltips/UI-Tooltip-Background", 
  edgeFile = [[Interface\Buttons\WHITE8x8]],
  edgeSize = 1,
});
ZBMWagoUrlFrame:SetBackdropColor(tonumber("0x"..ZN.Colors.HD:sub(1,2))/255, tonumber("0x"..ZN.Colors.HD:sub(3,4))/255, tonumber("0x"..ZN.Colors.HD:sub(5,6))/255, 1);
ZBMWagoUrlFrame:SetBackdropBorderColor(tonumber("0x"..ZN.Colors.INACTIVE:sub(1,2))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(3,4))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(5,6))/255, 1);
ZBMWagoUrlFrame.btnClose = ZN.CreateIconButton(ZBMWagoUrlFrame, "TOPRIGHT", ZBMWagoUrlFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
ZBMWagoUrlFrame.UrlBox = ZN.SingleLineEditBox("UrlBox", ZBMWagoUrlFrame, "CENTER", ZBMWagoUrlFrame, "CENTER", 250, 30, 0, 0, 20, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, ZBMWagoUrl, "CENTER")
-- ZBM Button Functions
WeakaurasSubframe.ZBMImportStringFrame.btnClose:SetScript("OnClick", function(self) WeakaurasSubframe.ZBMImportStringFrame:Hide() end)
WeakaurasSubframe.ZBMImportStringButton:SetScript("OnClick", function(self) WeakaurasSubframe.ZBMImportStringFrame:Show() end)
WeakaurasSubframe.ZBMWagoButton:SetScript("OnClick", function(self) ZBMWagoUrlFrame:Show() end)
ZBMWagoUrlFrame.btnClose:SetScript("OnClick", function(self) ZBMWagoUrlFrame:Hide() end)
-- ZND
WeakaurasSubframe.ZNDTitle = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZBMImportStringButton, "BOTTOMLEFT", 680, 30, 0, -30, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNReg.ttf", 18, ZN.Colors.ACTIVE, "ZND - Zero Note Display", "LEFT", "TOP")
WeakaurasSubframe.ZNDText = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZNDTitle, "BOTTOMLEFT", 680, 100, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNTitle.ttf", 14, ZN.Colors.ACTIVE,
"If you or members of your raid don't use ExRT, you can use the ZND Weakaura to show your notes on screen.\n\n"
.."Please visit wago.io for further information"
, "LEFT", "TOP", 8)
WeakaurasSubframe.ZNDImportStringButton = ZN.CreateGenericButton("ZBMImportStringButton", WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZNDText, "BOTTOMLEFT", 200, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "WA Import String", "CENTER",true )
WeakaurasSubframe.ZNDWagoButton = ZN.CreateGenericButton("ZBMWagoButton", WeakaurasSubframe, "LEFT", WeakaurasSubframe.ZNDImportStringButton, "RIGHT", 200, 30, 10, 0,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "wago.io", "CENTER",true )
-- ZND Import Frame
WeakaurasSubframe.ZNDImportStringFrame = ZN.createSubFrame("ZNDImportStringFrame", WeakaurasSubframe, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
WeakaurasSubframe.ZNDImportStringFrame.btnClose = ZN.CreateIconButton(WeakaurasSubframe.ZNDImportStringFrame, "TOPRIGHT", WeakaurasSubframe.ZNDImportStringFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
WeakaurasSubframe.ZNDImportStringFrame.editbox = ZN.MultiLineEditBox("ZNDImportEditBox", WeakaurasSubframe.ZNDImportStringFrame, "TOP", WeakaurasSubframe.ZNDImportStringFrame, "TOP", 680, 450, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, ZNDImportString, "LEFT")
-- ZND Wago Url Frame
ZNDWagoUrlFrame = ZN.createSubFrame("ZNDWagoUrlFrame",ZNFrame, 302, 152, ZN.Colors.ROWBG, 1, 'CENTER', 'TOOLTIP', true)
ZNDWagoUrlFrame:SetScript("OnMouseDown", function(self, button)end)
table.insert(ZN.DropDownsEdit, ZNDWagoUrlFrame)
ZNDWagoUrlFrame:SetBackdrop({bgFile = "Interface/Tooltips/UI-Tooltip-Background", 
  edgeFile = [[Interface\Buttons\WHITE8x8]],
  edgeSize = 1,
});
ZNDWagoUrlFrame:SetBackdropColor(tonumber("0x"..ZN.Colors.HD:sub(1,2))/255, tonumber("0x"..ZN.Colors.HD:sub(3,4))/255, tonumber("0x"..ZN.Colors.HD:sub(5,6))/255, 1);
ZNDWagoUrlFrame:SetBackdropBorderColor(tonumber("0x"..ZN.Colors.INACTIVE:sub(1,2))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(3,4))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(5,6))/255, 1);
ZNDWagoUrlFrame.btnClose = ZN.CreateIconButton(ZNDWagoUrlFrame, "TOPRIGHT", ZNDWagoUrlFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
ZNDWagoUrlFrame.UrlBox = ZN.SingleLineEditBox("UrlBox", ZNDWagoUrlFrame, "CENTER", ZNDWagoUrlFrame, "CENTER", 250, 30, 0, 0, 20, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, ZNDWagoUrl, "CENTER")
-- ZND Button Functions
WeakaurasSubframe.ZNDImportStringFrame.btnClose:SetScript("OnClick", function(self) WeakaurasSubframe.ZNDImportStringFrame:Hide() end)
WeakaurasSubframe.ZNDImportStringButton:SetScript("OnClick", function(self) WeakaurasSubframe.ZNDImportStringFrame:Show() end)
WeakaurasSubframe.ZNDWagoButton:SetScript("OnClick", function(self) ZNDWagoUrlFrame:Show() end)
ZNDWagoUrlFrame.btnClose:SetScript("OnClick", function(self) ZNDWagoUrlFrame:Hide() end)
--[[ ##############################################################################
  Player Group Imp / Exp
############################################################################## --]]
-- Import
GroupTemplateSubframe = ImpExpContent.GroupTemplateSubframe
GroupTemplateSubframe.ImportEditBox = ZN.MultiLineEditBox("GRPTemplateImportEditBox", GroupTemplateSubframe, "BOTTOM", GroupTemplateSubframe, "BOTTOM", 660, 180, 0, 15, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
GroupTemplateSubframe.ImportNameTextBox = ZN.SingleLineEditBox("ImportNameTextBox", GroupTemplateSubframe, "BOTTOMLEFT", GroupTemplateSubframe.ImportEditBox, "TOPLEFT", 400, 30, 0, 10, 10, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Enter Template Name", "LEFT")
GroupTemplateSubframe.TemplateImportButton = ZN.CreateGenericButton("TemplateImportButton", GroupTemplateSubframe, "BOTTOMRIGHT", GroupTemplateSubframe.ImportEditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Import", "CENTER",true )

GroupTemplateSubframe.TemplateImportButton:SetScript("OnClick", function(self) 
  local newTemplateName = GroupTemplateSubframe.ImportNameTextBox:GetText()
  local encstr = GroupTemplateSubframe.ImportEditBox.editbox:GetText()
  local decstr = ZN:dec(encstr)

  if newTemplateName == "Enter Template Name" or newTemplateName == "" then
    UIErrorsFrame:AddMessage("Please Enter a Name for your Template", 0.8, 0.07, 0.2, 5.0)    
    return
  end
  if encstr == "" then
    UIErrorsFrame:AddMessage("You need to insert an import string", 0.8, 0.07, 0.2, 5.0)
    return
  end

  ZNotes.GroupTemplates[newTemplateName] = loadstring(decstr)()

  GroupTemplateSubframe.ImportEditBox.editbox:SetText("|cff"..ZN.Colors.itemUncommon.."Template successfully imported as|r |cff"..ZN.Colors.chatInstance.."'"..newTemplateName.."'|r")
end)
-- Export
GroupTemplateSubframe = ImpExpContent.GroupTemplateSubframe
GroupTemplateSubframe.ExportEditBox = ZN.MultiLineEditBox("GRPTemplateExportEditBox", GroupTemplateSubframe, "TOP", GroupTemplateSubframe, "TOP", 660, 180, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
GroupTemplateSubframe.TemplateSelectButton = ZN.CreateGenericButton("ZNGroupTemplateSelectButton", GroupTemplateSubframe, "BOTTOMLEFT", GroupTemplateSubframe.ExportEditBox, "TOPLEFT", 240, 30, 0, 10,10,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Select Group Template..", "LEFT",true )
GroupTemplateSubframe.TemplateSelectButton.doOnUpdate = true
GroupTemplateSubframe.TemplateSelectButton.OnUpdate = function(_,_,_,newValue) selectedTemplate = newValue end
GroupTemplateSubframe.TemplateExportButton = ZN.CreateGenericButton("TemplateExportButton", GroupTemplateSubframe, "BOTTOMRIGHT", GroupTemplateSubframe.ExportEditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Export", "CENTER",true )

GroupTemplateSubframe.TemplateSelectButton:SetScript("OnClick", function(self) ZN:CreateDropdown(self, ZN:getTableKeys(ZNotes.GroupTemplates), ZN:getTemplateTableWithoutCurrentOrder(ZNotes.GroupTemplates), 240, ZN.Colors.INACTIVE, "LEFT", 10) end)
GroupTemplateSubframe.TemplateExportButton:SetScript("OnClick", function(self) 
  if selectedTemplate == nil or selectedTemplate == "Select Group Template.." then
    ZN:Print("You need to select a Group Template")
    return
  end
  local str = ZN:serializeTable(ZNotes.GroupTemplates[selectedTemplate], nil, true) 
  
  GroupTemplateSubframe.ExportEditBox.editbox:SetText(ZN:enc(str)) 
end)