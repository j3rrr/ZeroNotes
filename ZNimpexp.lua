local _, ZN, L = ...

local ZBMImportString = "!WA:2!TZxxSTr21bBAMD3wUBtSLJD3n7MSZoBKxsBkArklVoExLgrrkBLirjts5)KuOgY5soZkYzMDMH6h71bnc5HffinikT5lj7IGa9qlkq6dvTO9dDtAlCtYl9Lle6dciVzuG(uFzbsbAAtBpN79odhsouw2BtFQ0qKdV375Cp3Z5Cp3Z9Co0rQpKsSHCkowQ0PspuRHuhs9DtNTHT5gzZn)nl8WQM2Qe7Sk1wt120Y6ezBQF37QyRkv20SPRU1(kTD1mTN3Yv30WjM9wZxVUdX9AFHvF9F5XGxB3WwxT8wwe5I52JJSPmBAA)fJejs0THPPKLsns0mTTBA9YAUUwox5cxydLgMP0nVWCBTaX2X0qPzUSZDHlBRuJnlxQOJRITBSS6g6UXQwh(Wrl22U26nAaJVWzTfp(TZ6cZCwL22kp0PDvY6ed3sTRxxFZ9Qm1KLkxPu5jlwUiR9QxJO00vROHslItSTDSinBoJQtSDvjvbqWLG91Yp7ctV4S(4AbBcGRILwi)SZMTnqmvTAQSfXExeIsAMBmVXdCyFmjq5Rt2PTHGYITNQUZB12G1CgLMnToPc75Y8(NZuL8dp2E1mB2ULbNf9H6gUeBGxCdyncSHRVJIHElfKJCj6hFA6PYAyAq2xfwSyBvWLUTdPMPHQZdikoKsU2eJgUApZ243Wfe9CzBPOBaWsph980K0rEgAk4Xt0BlfvAQ3WO6u5luoFXSQeNAp8oeBtPSMoosaT6ydseKUJyVoN6o52TDiZQ3s3vlBttf1FMTUbOv126mfB1guCIv1vPjWcpd9ZfRyTMkoo4tzb2En8HDaORWAwlli2jyB215YFw)wRB1bb7QQdc1AaE3IHfBZMCi4djdh163L14(vfkZC9WOrJUq0rtnUnNBs0k6udGk6Ekg1af7fmb2onDvUQR2U8pZR2GyDYsVDBfBI00TB2u6MA6UKDTjnacezTpqDlqtsVgBnlGQeqbpvXMit5zRAROQ325R9CfDqP7tTJdPzD2KLP88lK1X02DxKptmubg3dbPiWHnCNgybM2vlozUzwSuM26Q7nE5IAwV9yTVzUp3d4tdFh4Ru1H0cegftNA0uJURRznHK55JuzhzD1IJkDNSZTdU98M6QUAp7E1TbvFqjrXvj6hYx9tJnHlNQLMQy(8f2rXU2SmLOV2ze7MNXaMSivbcSUEJy7whygtPBxRjzv7nf2c(B)h(mOPGJTlQlQZnuSNUrDtBU67zSEEq7Y0MiSIKh3BL32202zvWeHlBqrgQ25E3I7cCl71ye8PZ2OP5gA7QdyTKzB7AKx6y77s20n90MW2CGxpoTre6ZeHEnA69zWv0dx0NL(CzraxDN6WGNUPsdh75xS8SZuipdHvQ5PCeDheNzqCADIPT1VR01BROImjPYLPfPP3UQIWKwuWKM1jyKWuWWHDwTGfcI3sZKl)USoyI4IfN5QxR8dy0eNhD7ip0FAyud1H(6)m6L93lyagCS1OxbBG(gS3NK9(NN9(uS3)DyV)MS3ZYE)lWEph((d95nEtWS2OLrG833FUr2wAB8RTTjzHb6YPYY8wSIpdAec2iswEkfhxq1mRI9YloZiD(2iLqaaJUUMRsxb12Ead95nuQ2KOQXfH(B(IgKnCRi7wRTJRzlC(2mYW1zwinnIxjj)FO15eXKGx61LqQVcXyDjfdv)VKc2N4sKC1igSXHVAAcBPLSSnBinrpdmfztlDUfZY6TisJiDvIl(u8e(Gdtfd2pV0ODJx8LnbymgsoUObUuCD64YdNQoGQHDKLsYGnPuhkhFrA6qKcdp4W6mkd1yEFI)f(lRt2LYnE0r2jxS880N(hGgY3dnJyRZ2ATDDHmUytf7gKSOGXkL0J41iJmcZApCim8yXnWDFp1nSb1Yca1QrpvvnIcykG(npUTH5CeaZA0Vv06qhUMnA0KGdnhqfAzwJSfCGEBd15naJh1vat2AzX18UlaNCkvc7Idk9)h97Or)UGPDh8q1jB2K((wdLJ)nj4etjukz7qFpTUayB0q68gn3cg(jWZGLmHVi1AlSD(G)JacZODRQaf)DwntlLnNiRJlXkk0vMw6grPV)dy4wQjZuh99onqhUqlCtF0mwxIPRa6csWUhPn0bQrXYIapxLaQa8UQbEiPAUHHKUJKbHOsuVb9pa4w0)qGrr)2iLmn9BuTfboiOf08Vp9BADUfb9I8BwSSubtql2e20lX49SVI68RRO3e3iLIdErNwaVqa9CXlRbtwl9gAUaXROk5Akzy6QbQMaLHVlyNevezivYq8gko44KCa7vimifKOB2Qf4Rt(BvSmYwr)EacZNo5S1qwDiz9nO)jaPDL8OHdyNQ0Kn1HzdMKMMMRjbCljD4SnKynRlTfyixQMMc6QhiCLqfmgQpf967VUIToU0zM)xfu6W1zu0841ypIZ53MEQI6gwTDrQ(BfL(EhN(DrVxuCOVFr2uxLlvp9om)qAQBq0quWLTA9Tiaes)Z7GS336tpd7SkPsOhIsZKZHTgq38KqL0V7d4NLX62H(xEA6FLg9)Vg9KF)Zsh6Ff084g42J)rfnDvsru3sLEA6z8Af9DBpM9P2wQW70FB6ZVFdIbXwVg3VsQm9LPs0pn9Zq)uXOFWMp1M(2kb9bgOoCZnX6ybKeW8xGMzBiHUQRawLc0oOBZ0ZdyZKFm)sYD2niVIeS8tpk3qvk)jhHY75Eny7JgHPaahDzx1JGCTBtEJybTe2ZBaojPyxgWBdzVg9Rz2QQIRyz4BAhSnhaoFqcAXNKcwJWogNLGZiMj3k(913jaJmcjf4VdWSkTyVm)UgZJdP0f5GVqLS1skToSBrYsr32jEVuycjvZy9A7gwjRj9vMqsguXlwg3Sk33yWJp7RX1xk9ksHou0qbjLg8iCC(sRpGrXGFeFDO3mOKOpaqEQ0ax6Dlrr3ZagijLDRLwFPmRScB6681qbf3HsAsQ5gFSKiVNT7CgWf04imjsiniOWUdTVqBKKc1bInOds9vosoWHGSTuPw7WgWyRm4EzBmvLh8asp6G7l4wPZZOKrsp4rFiicfrdUxd9MjLgyVS9(h2Y)IHlpsmabsa9uUbL(gNNTLW(EWNfEO5JdHxz8qb4y9LYxyQ5xeVGmpScjL60q(c5skTWStEB45I5VA(cvYntPjZoB(EBoFbwRfRPrQTwvHX)xig9fPV0hYpB4gIdbDSE(7XidvZscZLYvbpoKJDF6RgdoRbp46dWdvO)DWHf4bfpG(3JhKaNwe599pTGr9jHZXskLkvQeDzBn(DkKdUOd4REk4UI49aNycMgMmFphcQ0eWe3ZsNBIHJlyp0rgnHYH4iRlx8XqY0GJEMLJ(nGh0jF7(S52)Wa7NWaG3WZYoe0HrCkEqOsCidwO6bi(E3)q1IyG3XbF6FdiM(rGW7vpdkRU(rtwfM0a076W(WL4es9t8OeAaYaH64JJiOhw6OhUibSfCe5BD8DW)OwVwc5m3bSx1Jb)zPdBnK4MM8aUnRzd9AwX9z1UCC5Hh8uGG3aJE2F4XO6NH(wRsJF9hcNToP6BbOJOoNUHgnbpGCDhuTl8UV4(U2kgoWLQ5rF7dQYc10MmxyRWEwBhLMwAkIUzbHyYO8pVAuEFtdK4MrQ6tP41lTjoojLym2KsQKMUk9Dj5(fHmE2aAUNRfF0gvWlpdh4pw3Uk1JJzkgWfdbrSp9lDoPmWFW1N1szPJ(ffx8S0fKY0NOLTyHJPIhNpmhDWZxeNjGgtN4czsailaRWBFwqWpKlvJYyUWBFu44l4y3vOctqSkxUumkAOLlk3kkkQ7iMrz1X5XYeh6QfzaUWhB0uJNEOnJm0wr2H1bxEVTxSBZa9VddHyh77a4dVFtjSfoaCLGNoeLa70jLAa)vf(tb(Zod8D4VQWFkz(OQwOy3iDS(8cMlrTt2iz1EUSaC)v3RL)wXdbn9jrzWNmD)(771FxRSaYUQSyesIWzziRX69g02JBj(82WN4OVL4ZB7rob1pUfQFfq)moheq1K3DIeEyl0bEBVbE7eb1b5QnzJspbCT2QW9QDiUmle)Z0JJgla1Up0lg1ZymTTPHRM1N0lAcyKXYP7WJLwrwK1Kh26HoU61wBRCcfin6ppkg(yfxSbIgD8tURt7QfzHN25oRtp1oWx5bWDF(hv4r8ndgoqrlMSyY9SIWk3jKOS4LlYmuL11D0bArteo4ke1gKSfmniEnGXD)vod9u7jc2yf4V39mwVcs6vyVXdAwfRkOpbvagsnDmq1r2XFiWkKhy1koAkaxOtkKEiVvVGNt)6wNI1cg(rm6Y1ybli7KWx)q(KPVjHhX7V6(8L8T5XEmclmLvqZ4613IMExUwfYVZwy(c5PNYg4z4yyrYT3iexbdT2U53eLNoBOSL1qbOxXu8shRRwVfV1OSWVwzdGDDtBfRTVP4H99rlZ8WVqWbcKxI9MPqb8SAw0KzDkKgRA9cHWE5pq)XDqmgkWxqWgeuteRxEqsgrkn0E3p5br(nIs)3Kh2G(lzsb6)o9Rt)pO)k6)5xL(Ff5GihJM(GiWNhNEQdIe9GiFmgF6Gip1brE6dI8mV0XoiYV5brIDqKNL(loiYZTlFDmB(PlhcHB4r4N7GiN4foiYjbe)XxLteHmCh)HJuOZJlfsxpecCVzMA(cv4P)kirq)ZgZ6ebo9xC(pzD63tJ(91O)an6FQg9p(00)IJt)Rp(dzXPnBtWmagK2mtMlxVqRSPg9B9tgIlQZeilcvNPaMeb6T2B9eVLHtRz)IBC73Ah)q6d81U8cbWtr2SPTRatEkRY6QBdEHlLvX2zFVu4WnYSRi1f(61SmH4ORsYIIgoMejeZ6eDcu)I8RP8tzwJslpCnAEFZemlzysWmu930Y6ypg5XdC3e0LOlt)y0Ns0OUQkXOyH83iFXID2MrxnkvHwL(BbExD2IS7jADLo5JysvvW22Y3KOS2KGLgNLxWCdIn7X5iQ6klZUMKZY1uCZKYSrJTvnRWqIg9tCwWp7x(FkKGKnYJ1lC49E7Ys5lV4cHhu9hxShlMFiF4(ghdWG0KvRAtwxNz3xelsm4g88y7FU7u5yWeJp1l95U8OJEz8gXYZQBSMiEbXUpIWswG9xGp8LiBHMKcGdhEpZGjJ0hzljFvItBhzezJp2LF9loEsr78eQVGPlVZlEPXg)IxgNJUUnfGqWie4S)9c2d76fIlSd0Re4CpMEPyFefi5MxQW8LLkp)ItDT)NqGGrDkaNWzT2nBYwSYD0lxgUr8vZxEMcxD6Itox(LXSLvurxTmMbgCrH8ZkxwojUozyqGTA2Moopzy715yJHbpAJLS6Nm0DjbXXqHaFTmnnEYW24CSHiqGlxBDMR7pz47IC85HeboHD8TmnuFYq5yCukWHN8GLw7NmeMriqyOWtIaUg(KHT0YmXbapUDs49nZ3oaB(gatXBYzPo73uxr0yGTAE3tp8RF3Pz4k3yoc6lld84rGMB4P6eDwH)uA(hzyojxBnyKSadkjsVCsrS(6eldFCU0m5wjyceyFhSSDV7)gbZBbltV9mm(a4xZGLuMGPrG3Cnyf2GOgspOxJWPpKq6cxGyalWpakrwoyNEU(JRDyqESbwav4rKLDzkVNr4ra1R1fwwxPzBpWtZIevWE9UC4ahGl4VAtrVz6R3EUQ(GggxsbDlEO3(frFN9b23yx8IJoAxubx4ICqXt4QnGgo74d4Jc3OYC6o1QC92OTDtJ5Gt(7ID0jWMm9K3W7QRIa5l)QYCvN(ZlplPIaCPt23y7jfjIukWIEkSftovk9q6h6bPcoU0LcOX6h1AKIxc2FHQJ2ngCg8d5YXb3vPr2KJy4bO9gWnoW2skHRazz)RVlk3aWvsgiOI2ys9FXCXLz9)ECxtEIVJlp6MWIvGgVzjDY0jWWMK(1tCHmJpEYJkCzsM5jcUXsowq4I5vze61JhYc8sjg4k8OVabc9XLgV4JliJN8scqgKSxecZqTNYLXOkCLUs3xNbeujEDpJCSK3(gbApmRC9tkOlybjdVGcpYiymLdZtn0iBcwmFfAxE64aaZ4aEHpVXSMkWLzIlJfiGSqQH2)QC1u3aBlfMhYu4vhqRySU7KJa2i7oJbWatmOOoHwzKMqwwk0S4(iWA)jZfr3e9nUqZh0axVDf3mVuD7v)eYRmqwXxbxgDhnDFskKXhkrjCgGPsKUNwBTvb(Hylcst8X4Y86vvorFJKxLgHK5FwTuWt6V8DV7DLdYo8bZFHiAzc2qdHqf1kbB)tyZwWAPqmPYHIIz1DC7Q4USAQZdfDWPijyenb3rI(vxcvbct2nkaUslf3AAXLh(E6Qxb2YptUuPKh((a2cBRqxjSWll9CFAcmZ4ECS(tW94S5ObFsETL(YlBVSXkN)1678kGIqi6qnOhfxrUN8xJkyXJhyGCj)GZYDWXkpjChMe(z6V)A2quFvG4iS8MdyRpq6udxYRegaXfQjFfHEco3Dr9SEt07013M3qZlVyhbEpTUzDXxAyLvgjbkehaqiZDgJsKAb1SWglBcngpejr8L(Y3FLZZW5GqklGgLaMypeu8H3SZ)saQycHwyL0bky6GhE1t8yGxo7SVeF3dncIRdfvC9KbGb40kMb2UrW7a8N3Xgy6Fw5qxxhMYwpkfc10q1be3LqqabZX4GY5)HO5ugd1E3BChie(rFb8Oe2uZi3gb3ccgnsnYW3JnMGklHv6obUOdoC(bDsbJOZs((HiM0eReOsxs3tLU4nMWRucHw1HU3DWCB22rwzjQB4aU1gNX1gCzCGVUxN9xj94Aj7Swt6RqF)buBhHiddRTdvOW2k8)jv(FFPYrA7)rBzIcyw4ozvKzpI4aswMG9WKRb44(4RNtq9owS3(LL6Fwou5sp6rSRG2hsdrN8iGqtyITl0jEfDJY2Gj4vo)rcrmzDyi5DQHNa0ZjljoQR1FnVNPJKmUpN4iimyxJpa55dlyDqAej8AEE9EO4jmL9hzHdEK6SxJb11nuJ3X93Kc2cqVYhX1Bqxj4Ur4jYLNM9s(rUCEKu9amcD0m0C)e)6Hxpia)iz9s4XHVnIoxFgRY7V0gDFXqEBSBfmG2xsGXvoePzSpQ28VxaPa4KCq33dMVhFAjP4HK((icG0X3t8gAEQo3prye4rIDYR25ar)GTkgOH7WUR1sWLGxzI1dD887hJVF(a3s(OuqODrTbJUxFLjyGWL4v5PDh6f)lsem(lyJIyDapnPTTYwHFTwS7KYxrU76uZZkQpWlLELeN7sJE(q6jZkj6HI8XEqkYsC1zjRfuCXFbQjIfMZXyiJWKRL)ksTDis3dJs8O3hfGZ2wzKXtnAaOQBPGwyLJNAKeYsPs5J6aJPPIJlquQ(XXqCassjW2rnflmc2Ck7km7GiotkjQQOn00bYYjO6cg0uSq4zXnhHhlkE5qcau)7DGrNi8GT0HgjNVJE0JGg9GQ76sdVzVh6EZjKEvbGDtGDJtmEJDJSbzR1Ff0tvWX6UhLaHTk)SAMMf1ILKxJSLSNM89t2vECXfxqvMM4Prs6UKwbQrvrenR122gR1uqXqNV1ghDIEevEJAIjyOzG)S76QGU7D7OymSiJ6vIT7OAwHx5cRspXzpiYfSgRRsiy(UkHGUkCGj1TVMPTbw7ahejTgRGBsl(vnUkiqWFFTKv5)stZXR9kI2EM26WcHL4LDV28fN5oZxO8KZs1(uNL(tUeDOOB79RAYwKVJIS0af1Mh)wNpfqKV5L2LLce2VlOS4VuoGWpiYO7ZBfhPbPz15aDbI92w2MwGShhZ2Evn2QzVRPzRiV7W2MTDr3JPo7jCUgnMFC6V3Mr(E(YV((Hd1RhBSZ566ulwlDcpxm)axYdSfQQk75m7WQNpX9Lt6d7vlTy2k4PmjchmDvbmlBSSblniJmYm5yhX6LRYTiUHc778o1aaG3smGUTXUThq39fuNKYdNwUta61NiDYlhuZvWNcs82UysLaFYcUITDrh2wsFLq3v67IPFHHVFVLr2Req4nGQ06GiXP)0h2DDWr)vSQNjg9taAvJTk9dS(DNQYuAkUOB1PWYde1GyvsZCehhLge()fhe)1Ut(IZJw3FTeXIj8AStS193Dw5Qlj73S8kynDGRT(R)FE5)ZQY2teJEYcNLo0pZ)3Ra(Bua)9k8JO)y(pUTi)CpvtjVAG3Irx8CjNusSdij(dyuLy7NMm(OyPH1BbuP8TxiFp297N(8fbbmpZr2et4JQEWc(dQevGMqUazd2V0Q(nB1rdGudhYeYYHzwRZVeVoPeZd55mniEtqF4V)mCmrFZ5J2oAWjpuQU3gsLQVRff(kPhl0O2b9bpCQRnz5kZv6QvMmxU5lW(5p8cXy)(gFr6lrF1y0pBgfJTWAU36fdvX3RYgPXVoTOD55xaRxTSyfosxN(VeJ(6xs8RI)n687HN(no9(DxhM0zPFt6thZ6vh8Ml)Itn62E1R5brIfOG)51VlVG)7RLt0Bl72PAu)ApNTO0tpiYz5)U5L1vFawQEfj1i6WPl4)rg4veCpte6T27TvU6B76m3u3zJwusmAJi71B5Xs1Ir1JDqKuSkOBO1)hV1)9"
local ZBMWagoUrl = "https://wago.io/ssH2QdjlK"
local ZNDImportString = "!WA:2!fRXsZTTXzjR6KPODMylN46gN0IGeztArXikhl7OeKgrkklMirjts5NsMceyjjSbbywaAj5hz6Ojth3M(ygDQtpQZ5K(d0o5q71D00FbEMETTto1J9B3feeGaGsoQZu5Xca7(9A3VV971QHV5O2LUC6mPZmARr1gv75V9b1uuFOg2QDoldl8NnYiJSYitM(kVOMfwdHZ6oz7tL1q)XpwbRjwXYYWrV9EowQpcHT1Tmp3Wv3fV1Y1RBJCw4V81wNy1HgAOACc0Cp(Z8AnqTpD5VOJcgjoFhddXB1u3bThg1aOqLTBJk1aB1PTl4L1Fm6K7ZFNlydp8WJuYwvXanY3PB6GWMkg3KZ)BGvuDGN2txY2rb7iKv3u3rOwD4HDtHDCW6nAaG(Mxa7(6VApnuTo1Rt5lEH8lUY8RUywhQqO0bRm1o2Trggf0SfEHDNAOhHmDkdqRV1(vZnB5kvlxz2sv8MAfmcMQu5vYV4ILmvAHSfkXMO2cifdNMz7astT2gkBJW72X0veeWB7UJ9PQ)7)XVCOHoX3YxU8r)H7RyQ20cVIfSyRLlFXk5lTRIPElf6kDAYPNNCUSMwMOVfPyJk7GrMnCA(QhObYpfIQ0vd2gPAzQzVdfg6ALCPSTu0nbCjxIm(RssrMGKgE9m9pIKUw7F6KI3T4CItiExe2sSOLdsCoDB664aLooGSTCB2UUW(1XWQgKbfhLr(oUCppDiklRvoxP85lUVUzDlmx6p7(mvnFHUrnqeRR3qyxBKrD2YDVSlxPYYlTy(5RShSjxIzIylmvhDT9)SBRF1VyZ5xQ(812JU205IqwdlfTPZc6n1ZwQvhWavOKQHIT9zjFQqwBWAI(IRbvbtGVJmQ6LE(yGC4yOBc76RwzXcfZtYmZ87u3c03ak1AH0070ICU91q2QyD2YnRdAlN2lW2ouvmfRHeBPy2rXWyBrhRgnmqAI12we3X0u3SHOttDBroYZik9(WW0n10CitKuQ0M6AonpzDY5QXhd3XgnhWUMt9q02zBQdYRgQUcSK2il14Q9zwagJRoSmflHORCYNpcqbYIKLAskITBATPjAtYnAF(YWRIW7C43SjYueJur6pcPrwzdaT914Q0kWQsAm19u7y7y1I(1wNSr9oMSdwjskic)yybh)ePRFrzrjj2y61fnTCePhBQImFuAUYmnvUH1oYKbKlGWchSqGJZIkMA9(kTAhmoRLTDqeO)4rwZcZb8mmkEqJm18E)OWt4Tfb9Ee8emtf1LZKs8DJaAnRaW2pt8a8E6RN2rVfkmxPNjKLLOtkfM5D)XDRgakLi1(uu2BRybGKgOkWujINVPIzkq3Lumso6QwPpsZirKqnXebGtsukD6yedvlWxxm769Mh2SLKsEC5LJLJIXHXqFanaUgGN0TEGZRzkfcwKHnkwvFmIIRUNn7HQ8zq1v7l2N6phDYbTXNkskt)5W2CEzXKfRux7LMHhrtrMmDS1uhobIxkJJS(840)3DFV7t2VWiNoytg76nOaaYb2nv0S28o8aIV1qKlss0(u98eVABnfhiFf2JxaXETOXrvVfnYr2zHpjNcsi4S7QzvLJutYOxGSoezL91wVYJNyIkSGluBoQ)AKyhBi6uKrKee8S1Ojj1q2b3bj4BuAmf(GEdXs7I6ss2u3O3WOcZjpPGFN4WNcUHmQE97jbmwA9EheYHrWkKL6qcj2dPuImGsjUAHvGuhnDss3Xee8W2vW5hl0Cf2(NvUVizXHDDfQTcJbctmr4Lh4tIUa9nfSeHbHvvxoigLJAQ)0cMLrQ2Py6)KDJDgblOEnseyptoa3aFxbvqmmcSNlNjzqVlCpkidL22WQ86igNsKmIvOhk9ez6reVpMWLicHoz5AE3ZmHN7zfRCa3FOVTGKP6DgiWbey)OhuF8KbxccrCQDMgq6HjKEQ6yBf8FsP87EpcmWbHWv2bkvV(vUYvQpTYKtoZKtYaR3yq8hx)bWe)VEdGz0fNre3DVBebFUQf768noRk60mqTdAL4BI75sJ1pCi(ezFXq))P2rYnUaxv8YRJ6UtEu1c9Pk1nDhWFEXU1ArxkwMDAvdH7hUUQNUq(XYI9zK3DLYS(Iq85CQLUjLn2qLKMnsZlRkH0ytov66GJs4JMPRByzHt4YO3F6jtMSpAyZpyFKPbugiJTxkaTCLx6mWo(mWMpLUEBPW)jNrG863)cK345V(lGkBQQySPY22uV0B0(00bAGGQV0vPbvw2CJdc85lSzpYzzzaXhnjVn5NTlZwSieAyyOGN7t(5c7ZJYXk4Tg4hZPJ9oDRcE0mKZtElI4E58kveI3Xkoplno6bqahJYEu8aQa5XGni3FRHR6zmKiOsSx4l6XMab0cgujOgEGXTcv2J)QPKJVqRiDL2pKUvfYe3GcFpzIoFmIlmLB4XbjL(ajG8eibiyP29OMa5SKFsj1Mi1hsUl5nf2LQbCWkQpCdIe5DjVNay68xzAAerK0auOuLzRAkoIlA1Gctx9pL9K7ZBjJD7M5lMB5vPDnH3TMuI9giFX5sjUYIZEh49s5VE(IvNRq5zZUy((hoFr3rZT8szNTs1fx(6vZFZ8fRuD1IZxyrGw5NdmsoX)Yl9cg3tjwaWjD60bTy4tkkd1o3NW1l5swW)cZ9LqeCoYq0EF4fPqZXoGZBwEbCcqvNIH1z9Y3qw0lFGWGHy1DZZ6iteuPxqc5N8SWZRtnmA6e062NzqadfylQ3kDa74srLBt3MXLQAO)5g9sgui(7mq)cjBhSlzyYaRJEUD8B1C5YxUCefT1FnG3sXrTjZLIViRrwQxObgySx5ehZG3uv4KjhpJWGkIj((P4pej5Tpb58NGOxIMtJg9im59ol1B54F)piahk7zitT6KdyfEONgCpR(96Wa3kFYbFkHM4FCg4W0X4BmItiUrgPDE7bSTRhHMsXC72NwH9EfE)HxYsd9nd1(8(6pxvEy6QTDFH0H8A3yNnTWA3cR0ENB5(swA)lBFQ5X6pw8gDu0OTLvSsfYmcKpP((uhSqiFAdyBY82sdhIBsML2GuYVG(BS78W7xG8J2ilwrxBdsw4ZBwQnSHS9gt5Gm3ypNnbnX21bzEJA833yN6gOT0RzabpN)nCRR9286AhHiqk0(DIC9qTJQQTTPslD1MTF34HPngPQt75)iLu7EFfJqUgUYYRWAxCD9TqAScJ)QFm(bqGb96BNLod5K0BPqsxBFApTD7Jn5vw4p)p)G)ZqWpKPgHCzYhq(O9tGVU9vuVCcTPRqU6fiL3GS8gKXw4txDO)gfW95lQExkbrwGCfbssEp5d2x93)W70(ZhJmhjp5R5RKvpb5MBn8FQVYvd39vp7l6EuqZD2iSgC1dxkwY(YW(jmZYzsmM24jFMukpCVE5vZwTaeppz0OPR5IZAMRzYssFIjGZo0etA6MTZ2iNiX9PpvLLOUuYyMMLhpoMPh7ju1)mjU39F26JNCmqMLglJlSDBy7183D2Wvv8eSdKFQoKNQ)vm2zrDBN7PVEYaE5ITxnKXgM2EgYDG0vUhznwNxeOj5Y64c4d8h8Ac5QMRPItbZ6wPP3DHTdcpRMML5siBBLgi(9fL4I3nFPLlUCL8xmPVMRq1EYsXCVlsEnpPxBT9cT4MQgFyP1PEBORMqnGK27Ew3NJQqhUbWCj66WnCh3L9QUPlmDlArkUQN8SQsWVxnx8C)WFbtbM3FTv0XPBnDWu53gzGuDsC5uqMlSqT09ApK9r9EOi90k02hhyu6HKc0RsSUIkAT1OsOn8O4nRUuHY5QEJvZxUsHLlU0SL(CPK06BYm9tDKcLpRFA6MvBFMxYIpHHaie(4xffCdKd4RL1PR1wB1ctuc806nmvEQMzMjbEM67l6tD8q)Yhp0)GJh6x54H(0hp0V6Xd9R5I(ZiVErVAyyfJsEhAHSSSMOL48McqrSSQBWVi3cqoVlv(6vNDU5wUi4nr4p2R(t3uQAZCFWBErkrvWVRjYifCMWudH9AbehkwAsD9ZuTYDwjFFzWg(6jIT1CCkkl7rpPqxWhZRTSur0MuVwsd4(8GW4uqKLc2xD3tubZLY9MwCj(CwMOUmie9NyIiUvr5qSDMw0K0dfplzF0QF0IIsXgyCWR7JaDePeQFhZbjl35OoixzIy8ykol6RKbOXGGXxvnHHKgaMDnv6MrSbX3RV49U)A41mxF8lMmQlrLlXUctyoez5sh(a9UfvGKujSRIpu6ejJ6ADzig7T0rBKNB3Z0n1yT3nL0msjJhd3Dv6smTRq1lYhNuC5JtlMHaLG04utkLckajP4LeNEsXXhiEClOG4fP8e7fJ9skO3)iZW(Q2mUXCVZtMgl28)IqNrneFq)zcoycZZk8brNv4dwp5rsE7Ux1Ttd(n1cMQDYy(ZhWp6XBa1pG(ul9nvY4mzPjp6V7a9H36d26DqykN5L3iBG0BqtoEMJSbwaJzVRVyGux4qVgB)D5jKGhOBxds0I0Wx2V15rRoTbrI(Q7AWGgOgSO2a5x9tqNPpHny8w4h(QmabI8KDScelRakTec)NpsBWtLtc6KrUGcFD)YUVh(qQSEewCdStAbUIGipufS36HmAIT1Cr1d1ipPDOzDWVRSJqgy9)NZaTq4VG0H8EcKnjBr2(BgI8yw3OixJ8BjpJ8LSMnnnVDsUTwkl73Z)gKNZ6ee52V1qKFZiKxzyAdu(9K)GxhA(wA1VL4)vQHj)6MDBndVdlJ)QSgO4Rdl9nYzcnYhT)1(WIx(XF4C1lEZAKRkqYiq2L37MF3x9JPnV5jKNo6J(73()o"
local ZNDWagoUrl = "https://wago.io/LjFE8wNMN"

local selectedTemplate = nil

ImpExpSidebar = ZNSidebarFrame.Subframes.ImpExp
ImpExpContent = ZNBodyFrame.Subframes.ImpExp

ImpExpSidebar.ImpExpPlayerDbButton = ZN.CreateGenericButton("ImpExpPlayerDbButton", ImpExpSidebar, "TOPLEFT", ImpExpSidebar, "TOPLEFT", 240, 30, 0, -30,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Playerspell DB", "CENTER",true )
ImpExpSidebar.ImpExpBossTemplateButton = ZN.CreateGenericButton("ImpExpBossTemplateButton", ImpExpSidebar, "TOPLEFT", ImpExpSidebar.ImpExpPlayerDbButton, "BOTTOMLEFT", 240, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Boss Templates", "CENTER",true )
ImpExpSidebar.ImpExpGroupTemplateButton = ZN.CreateGenericButton("ImpExpBossTemplateButton", ImpExpSidebar, "TOPLEFT", ImpExpSidebar.ImpExpBossTemplateButton, "BOTTOMLEFT", 240, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Group Templates", "CENTER",true )
ImpExpSidebar.ImpExpBossWeakaurasButton = ZN.CreateGenericButton("ImpExpBossWeakaurasButton", ImpExpSidebar, "TOPLEFT", ImpExpSidebar.ImpExpGroupTemplateButton, "BOTTOMLEFT", 240, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Weakauras", "CENTER",true )

ImpExpContent.ImpExpInfoSubframe = ZN.createSubFrame("ImpExpInfoSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","HIGH", false, 0, 0)
ImpExpContent.PlayerDbSubframe = ZN.createSubFrame("PlayerDbSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
ImpExpContent.BossTemplateSubframe = ZN.createSubFrame("BossTemplateSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
ImpExpContent.GroupTemplateSubframe = ZN.createSubFrame("GroupTemplateSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
ImpExpContent.WeakaurasSubframe = ZN.createSubFrame("WeakaurasSubframe", ImpExpContent, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)

ImpExpSidebar.ImpExpPlayerDbButton:SetScript("OnClick", function(self) ZN:ToggleImpExpView("ImpExpContent.PlayerDbSubframe") end)
ImpExpSidebar.ImpExpBossTemplateButton:SetScript("OnClick", function(self) ZN:ToggleImpExpView("ImpExpContent.BossTemplateSubframe") end)
ImpExpSidebar.ImpExpGroupTemplateButton:SetScript("OnClick", function(self) ZN:ToggleImpExpView("ImpExpContent.GroupTemplateSubframe") end)
ImpExpSidebar.ImpExpBossWeakaurasButton:SetScript("OnClick", function(self) ZN:ToggleImpExpView("ImpExpContent.WeakaurasSubframe") end)
--[[ ##############################################################################
  Imp / Exp Info
############################################################################## --]]
ImpExpInfoSubframe = ImpExpContent.ImpExpInfoSubframe
ImpExpInfoSubframe.UrlButton = ZN.CreateGenericButton("HomeUrlButton", ImpExpInfoSubframe, "BOTTOM", ImpExpInfoSubframe, "BOTTOM", 640, 30, 0, 0,0,0, 10, ZN.Colors.INACTIVE, ZN.Colors.BG, nil, "www.zero-wow.de", "CENTER",false )
ImpExpInfoSubframe.UrlButton:SetScript("OnClick", function(self) ZN:ToggleInfo(self) end)
ImpExpInfoSubframe.MainTitle = ZN.CreateText(ImpExpInfoSubframe, "TOP", ImpExpInfoSubframe, "TOP", 680, 30, 0, -30, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNVers.ttf", 18, ZN.Colors.ACTIVE, "Import / Export", "LEFT", "TOP")
ImpExpInfoSubframe.MainIntro = ZN.CreateText(ImpExpInfoSubframe, "TOP", ImpExpInfoSubframe.MainTitle, "BOTTOM", 680, 300, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNTitle.ttf", 14, ZN.Colors.ACTIVE, 
"Here you can import Boss Templates and Spell Setups or export yours to share with others.\n\n"
.."|cff"..ZN.Colors.chatYell.."Warning:|r Importing a new Playerspell DB will override your current DB!\n\n"
.."If you want to extend the usage of your notes or you / member of your raid don't use ExRT have a look at the Weakauras Tab."
, "LEFT", "TOP",8)
--[[ ##############################################################################
  Player DB Imp / Exp
############################################################################## --]]
PlayerDbSubframe = ImpExpContent.PlayerDbSubframe
PlayerDbSubframe.EditBox = ZN.MultiLineEditBox("PlayerDbEditBox", PlayerDbSubframe, "TOP", PlayerDbSubframe, "TOP", 660, 450, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
PlayerDbSubframe.PlayerDbImportButton = ZN.CreateGenericButton("PlayerDbImportButton", PlayerDbSubframe, "BOTTOMRIGHT", PlayerDbSubframe.EditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Import Spell DB", "CENTER",true )
PlayerDbSubframe.PlayerDbExportButton = ZN.CreateGenericButton("PlayerDbExportButton", PlayerDbSubframe, "RIGHT", PlayerDbSubframe.PlayerDbImportButton, "LEFT", 200, 30, -10, 0,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Export Spell DB", "CENTER",true )
--Import Player DB Confirmation
ZNPlayerImportConfirmFrame = ZN.createSubFrame("ZNPlayerImportConfirmFrame",ZNFrame, 302, 202, ZN.Colors.ROWBG, 1, 'CENTER', 'TOOLTIP', true)
ZNPlayerImportConfirmFrame:SetScript("OnMouseDown", function(self, button)end)
table.insert(ZN.DropDownsEdit, ZNPlayerImportConfirmFrame)
ZNPlayerImportConfirmFrame:SetBackdrop({bgFile = "Interface/Tooltips/UI-Tooltip-Background", 
  edgeFile = [[Interface\Buttons\WHITE8x8]],
  edgeSize = 1,
});
ZNPlayerImportConfirmFrame:SetBackdropColor(tonumber("0x"..ZN.Colors.HD:sub(1,2))/255, tonumber("0x"..ZN.Colors.HD:sub(3,4))/255, tonumber("0x"..ZN.Colors.HD:sub(5,6))/255, 1);
ZNPlayerImportConfirmFrame:SetBackdropBorderColor(tonumber("0x"..ZN.Colors.INACTIVE:sub(1,2))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(3,4))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(5,6))/255, 1);

ZNPlayerImportConfirmFrame.btnClose = ZN.CreateIconButton(ZNPlayerImportConfirmFrame, "TOPRIGHT", ZNPlayerImportConfirmFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
ZNPlayerImportConfirmFrame.Title = ZN.CreateText(ZNPlayerImportConfirmFrame, "TOP", ZNPlayerImportConfirmFrame, "TOP", 150, 30, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNReg.ttf", 14, ZN.Colors.ACTIVE, "IMPORT PLAYER DB")
ZNPlayerImportConfirmFrame.Message = ZN.CreateText(ZNPlayerImportConfirmFrame, "TOP", ZNPlayerImportConfirmFrame, "TOP", 260, 60, 0, -40, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNReg.ttf", 12, ZN.Colors.ACTIVE, "Importing will override your local Database\nAre you sure?", "CENTER")
ZNPlayerImportConfirmFrame.ConfirmButton = ZN.CreateGenericButton("ZNImportPlayerConfirmButton", ZNPlayerImportConfirmFrame, "BOTTOMLEFT", ZNPlayerImportConfirmFrame, "BOTTOMLEFT", 125, 30, 20, 20,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Confirm", "CENTER",true, ZN.Colors.HD )
ZNPlayerImportConfirmFrame.CancelButton = ZN.CreateGenericButton("ZNImportPlayerCancelButton", ZNPlayerImportConfirmFrame, "BOTTOMRIGHT", ZNPlayerImportConfirmFrame, "BOTTOMRIGHT", 125, 30, -20, 20,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Cancel", "CENTER",true, ZN.Colors.HD )

ZNPlayerImportConfirmFrame.btnClose:SetScript("OnClick", function(self) ZNPlayerImportConfirmFrame:Hide() end)
ZNPlayerImportConfirmFrame.CancelButton:SetScript("OnClick", function(self) ZNPlayerImportConfirmFrame:Hide() end)
-- Import
ZNPlayerImportConfirmFrame.ConfirmButton:SetScript("OnClick", function(self) 
  local str = PlayerDbSubframe.EditBox.editbox:GetText() 
  if not str or str == "" then
    UIErrorsFrame:AddMessage("Insert Import String", 0.8, 0.07, 0.2, 5.0)
    return
  end
  local decstr = ZN:dec(str)
  ZNotes.PlayerSpells = loadstring(decstr)()  
  ZN:ReloadPlayerTable()
  ZN:Print("Imported Player DB")
  ZNPlayerImportConfirmFrame:Hide()
end)
-- Export
-- https://stackoverflow.com/questions/6075262/lua-table-tostringtablename-and-table-fromstringstringtable-functions
PlayerDbSubframe.PlayerDbExportButton:SetScript("OnClick", function(self) 
  local str = ZN:serializeTable(ZNotes.PlayerSpells, nil, true) 
  
  PlayerDbSubframe.EditBox.editbox:SetText(ZN:enc(str)) 
end)

PlayerDbSubframe.PlayerDbImportButton:SetScript("OnClick", function(self) 
  ZNPlayerImportConfirmFrame:SetShown(not ZNPlayerImportConfirmFrame:IsShown());
end)
--[[ ##############################################################################
  Boss Template Imp / Exp
############################################################################## --]]
-- Import
BossTemplateSubframe.ImportEditBox = ZN.MultiLineEditBox("TemplateImportEditBox", BossTemplateSubframe, "BOTTOM", BossTemplateSubframe, "BOTTOM", 660, 180, 0, 15, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
BossTemplateSubframe.ImportNameTextBox = ZN.SingleLineEditBox("ImportNameTextBox", BossTemplateSubframe, "BOTTOMLEFT", BossTemplateSubframe.ImportEditBox, "TOPLEFT", 400, 30, 0, 10, 10, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Enter Template Name", "LEFT")
BossTemplateSubframe.TemplateImportButton = ZN.CreateGenericButton("TemplateImportButton", BossTemplateSubframe, "BOTTOMRIGHT", BossTemplateSubframe.ImportEditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Import", "CENTER",true )

BossTemplateSubframe.TemplateImportButton:SetScript("OnClick", function(self) 
  local newTemplateName = BossTemplateSubframe.ImportNameTextBox:GetText()
  local encstr = BossTemplateSubframe.ImportEditBox.editbox:GetText()
  local decstr = ZN:dec(encstr)

  if newTemplateName == "Enter Template Name" or newTemplateName == "" then
    UIErrorsFrame:AddMessage("Please Enter a Name for your Template", 0.8, 0.07, 0.2, 5.0)    
    return
  end
  if encstr == "" then
    UIErrorsFrame:AddMessage("You need to insert an import string", 0.8, 0.07, 0.2, 5.0)
    return
  end

  ZNotes.BossTemplates[newTemplateName] = loadstring(decstr)()

  BossTemplateSubframe.ImportEditBox.editbox:SetText("|cff"..ZN.Colors.itemUncommon.."Template successfully imported as|r |cff"..ZN.Colors.chatInstance.."'"..newTemplateName.."'|r")
end)
-- Export
BossTemplateSubframe = ImpExpContent.BossTemplateSubframe
BossTemplateSubframe.ExportEditBox = ZN.MultiLineEditBox("TemplateExportEditBox", BossTemplateSubframe, "TOP", BossTemplateSubframe, "TOP", 660, 180, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
BossTemplateSubframe.TemplateSelectButton = ZN.CreateGenericButton("ZNBossTemplateSelectButton", BossTemplateSubframe, "BOTTOMLEFT", BossTemplateSubframe.ExportEditBox, "TOPLEFT", 240, 30, 0, 10,10,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Select Boss Template..", "LEFT",true )
BossTemplateSubframe.TemplateSelectButton.doOnUpdate = true
BossTemplateSubframe.TemplateSelectButton.OnUpdate = function(_,_,_,newValue) selectedTemplate = newValue end
BossTemplateSubframe.TemplateExportButton = ZN.CreateGenericButton("TemplateExportButton", BossTemplateSubframe, "BOTTOMRIGHT", BossTemplateSubframe.ExportEditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Export", "CENTER",true )

BossTemplateSubframe.TemplateSelectButton:SetScript("OnClick", function(self) ZN:CreateDropdown(self, ZN:getTableKeys(ZNotes.BossTemplates), ZN:getTableOrder(ZNotes.BossTemplates), 240, ZN.Colors.INACTIVE, "LEFT", 10) end)
BossTemplateSubframe.TemplateExportButton:SetScript("OnClick", function(self) 
  if selectedTemplate == nil or selectedTemplate == "Select Boss Template.." then
    ZN:Print("You need to select a Boss Template")
    return
  end
  local str = ZN:serializeTable(ZNotes.BossTemplates[selectedTemplate], nil, true) 
  
  BossTemplateSubframe.ExportEditBox.editbox:SetText(ZN:enc(str)) 
end)
--[[ ##############################################################################
  Weakauras
############################################################################## --]]
WeakaurasSubframe = ImpExpContent.WeakaurasSubframe
WeakaurasSubframe.Title = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe, "TOPLEFT", 680, 30, 0, -30, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNVers.ttf", 18, ZN.Colors.ACTIVE, "Zero Weakauras", "LEFT", "TOP")
WeakaurasSubframe.IntroText = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.Title, "BOTTOMLEFT", 680, 50, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNTitle.ttf", 14, ZN.Colors.ACTIVE,
"There are two Weakauras to supplement ZeroNotes."
, "LEFT", "TOP", 8)
-- ZBM
WeakaurasSubframe.ZBMTitle = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.IntroText, "BOTTOMLEFT", 680, 30, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNReg.ttf", 18, ZN.Colors.ACTIVE, "ZBM - Zero Boss Mods", "LEFT", "TOP")
WeakaurasSubframe.ZBMText = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZBMTitle, "BOTTOMLEFT", 680, 100, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNTitle.ttf", 14, ZN.Colors.ACTIVE,
"The ZBM Weakaura will show bossmod-like bars for your note. You can choose whether you want to have bars for every assigned cooldown or only your own.\n\n"
.."Please visit wago.io for further information"
, "LEFT", "TOP", 8)
WeakaurasSubframe.ZBMImportStringButton = ZN.CreateGenericButton("ZBMImportStringButton", WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZBMText, "BOTTOMLEFT", 200, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "WA Import String", "CENTER",true )
WeakaurasSubframe.ZBMWagoButton = ZN.CreateGenericButton("ZBMWagoButton", WeakaurasSubframe, "LEFT", WeakaurasSubframe.ZBMImportStringButton, "RIGHT", 200, 30, 10, 0,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "wago.io", "CENTER",true )
-- ZBM Import Frame
WeakaurasSubframe.ZBMImportStringFrame = ZN.createSubFrame("ZBMImportStringFrame", WeakaurasSubframe, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
WeakaurasSubframe.ZBMImportStringFrame.btnClose = ZN.CreateIconButton(WeakaurasSubframe.ZBMImportStringFrame, "TOPRIGHT", WeakaurasSubframe.ZBMImportStringFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
WeakaurasSubframe.ZBMImportStringFrame.editbox = ZN.MultiLineEditBox("ZBMImportEditBoxFrame", WeakaurasSubframe.ZBMImportStringFrame, "TOP", WeakaurasSubframe.ZBMImportStringFrame, "TOP", 680, 450, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, ZBMImportString, "LEFT")
-- ZBM Wago Url Frame
ZBMWagoUrlFrame = ZN.createSubFrame("ZBMWagoUrlFrame",ZNFrame, 302, 152, ZN.Colors.ROWBG, 1, 'CENTER', 'TOOLTIP', true)
ZBMWagoUrlFrame:SetScript("OnMouseDown", function(self, button)end)
table.insert(ZN.DropDownsEdit, ZBMWagoUrlFrame)
ZBMWagoUrlFrame:SetBackdrop({bgFile = "Interface/Tooltips/UI-Tooltip-Background", 
  edgeFile = [[Interface\Buttons\WHITE8x8]],
  edgeSize = 1,
});
ZBMWagoUrlFrame:SetBackdropColor(tonumber("0x"..ZN.Colors.HD:sub(1,2))/255, tonumber("0x"..ZN.Colors.HD:sub(3,4))/255, tonumber("0x"..ZN.Colors.HD:sub(5,6))/255, 1);
ZBMWagoUrlFrame:SetBackdropBorderColor(tonumber("0x"..ZN.Colors.INACTIVE:sub(1,2))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(3,4))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(5,6))/255, 1);
ZBMWagoUrlFrame.btnClose = ZN.CreateIconButton(ZBMWagoUrlFrame, "TOPRIGHT", ZBMWagoUrlFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
ZBMWagoUrlFrame.UrlBox = ZN.SingleLineEditBox("UrlBox", ZBMWagoUrlFrame, "CENTER", ZBMWagoUrlFrame, "CENTER", 250, 30, 0, 0, 20, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, ZBMWagoUrl, "CENTER")
-- ZBM Button Functions
WeakaurasSubframe.ZBMImportStringFrame.btnClose:SetScript("OnClick", function(self) WeakaurasSubframe.ZBMImportStringFrame:Hide() end)
WeakaurasSubframe.ZBMImportStringButton:SetScript("OnClick", function(self) WeakaurasSubframe.ZBMImportStringFrame:Show() end)
WeakaurasSubframe.ZBMWagoButton:SetScript("OnClick", function(self) ZBMWagoUrlFrame:Show() end)
ZBMWagoUrlFrame.btnClose:SetScript("OnClick", function(self) ZBMWagoUrlFrame:Hide() end)
-- ZND
WeakaurasSubframe.ZNDTitle = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZBMImportStringButton, "BOTTOMLEFT", 680, 30, 0, -30, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNReg.ttf", 18, ZN.Colors.ACTIVE, "ZND - Zero Note Display", "LEFT", "TOP")
WeakaurasSubframe.ZNDText = ZN.CreateText(WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZNDTitle, "BOTTOMLEFT", 680, 100, 0, 0, "Interface\\AddOns\\ZeroNotes\\Media\\Font\\ZNTitle.ttf", 14, ZN.Colors.ACTIVE,
"If you or members of your raid don't use ExRT, you can use the ZND Weakaura to show your notes on screen.\n\n"
.."Please visit wago.io for further information"
, "LEFT", "TOP", 8)
WeakaurasSubframe.ZNDImportStringButton = ZN.CreateGenericButton("ZBMImportStringButton", WeakaurasSubframe, "TOPLEFT", WeakaurasSubframe.ZNDText, "BOTTOMLEFT", 200, 30, 0, -10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "WA Import String", "CENTER",true )
WeakaurasSubframe.ZNDWagoButton = ZN.CreateGenericButton("ZBMWagoButton", WeakaurasSubframe, "LEFT", WeakaurasSubframe.ZNDImportStringButton, "RIGHT", 200, 30, 10, 0,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "wago.io", "CENTER",true )
-- ZND Import Frame
WeakaurasSubframe.ZNDImportStringFrame = ZN.createSubFrame("ZNDImportStringFrame", WeakaurasSubframe, 680, 530, ZN.Colors.BG, 1, "TOP","DIALOG", true, 0, 0)
WeakaurasSubframe.ZNDImportStringFrame.btnClose = ZN.CreateIconButton(WeakaurasSubframe.ZNDImportStringFrame, "TOPRIGHT", WeakaurasSubframe.ZNDImportStringFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
WeakaurasSubframe.ZNDImportStringFrame.editbox = ZN.MultiLineEditBox("ZNDImportEditBox", WeakaurasSubframe.ZNDImportStringFrame, "TOP", WeakaurasSubframe.ZNDImportStringFrame, "TOP", 680, 450, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, ZNDImportString, "LEFT")
-- ZND Wago Url Frame
ZNDWagoUrlFrame = ZN.createSubFrame("ZNDWagoUrlFrame",ZNFrame, 302, 152, ZN.Colors.ROWBG, 1, 'CENTER', 'TOOLTIP', true)
ZNDWagoUrlFrame:SetScript("OnMouseDown", function(self, button)end)
table.insert(ZN.DropDownsEdit, ZNDWagoUrlFrame)
ZNDWagoUrlFrame:SetBackdrop({bgFile = "Interface/Tooltips/UI-Tooltip-Background", 
  edgeFile = [[Interface\Buttons\WHITE8x8]],
  edgeSize = 1,
});
ZNDWagoUrlFrame:SetBackdropColor(tonumber("0x"..ZN.Colors.HD:sub(1,2))/255, tonumber("0x"..ZN.Colors.HD:sub(3,4))/255, tonumber("0x"..ZN.Colors.HD:sub(5,6))/255, 1);
ZNDWagoUrlFrame:SetBackdropBorderColor(tonumber("0x"..ZN.Colors.INACTIVE:sub(1,2))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(3,4))/255, tonumber("0x"..ZN.Colors.INACTIVE:sub(5,6))/255, 1);
ZNDWagoUrlFrame.btnClose = ZN.CreateIconButton(ZNDWagoUrlFrame, "TOPRIGHT", ZNDWagoUrlFrame, "TOPRIGHT", 16, 16, -10, -10, "Interface\\AddOns\\ZeroNotes\\Media\\Texture\\x_big_active", ZN.Colors.ACTIVE, ZN.Colors.INACTIVE, false)
ZNDWagoUrlFrame.UrlBox = ZN.SingleLineEditBox("UrlBox", ZNDWagoUrlFrame, "CENTER", ZNDWagoUrlFrame, "CENTER", 250, 30, 0, 0, 20, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, ZNDWagoUrl, "CENTER")
-- ZND Button Functions
WeakaurasSubframe.ZNDImportStringFrame.btnClose:SetScript("OnClick", function(self) WeakaurasSubframe.ZNDImportStringFrame:Hide() end)
WeakaurasSubframe.ZNDImportStringButton:SetScript("OnClick", function(self) WeakaurasSubframe.ZNDImportStringFrame:Show() end)
WeakaurasSubframe.ZNDWagoButton:SetScript("OnClick", function(self) ZNDWagoUrlFrame:Show() end)
ZNDWagoUrlFrame.btnClose:SetScript("OnClick", function(self) ZNDWagoUrlFrame:Hide() end)
--[[ ##############################################################################
  Player Group Imp / Exp
############################################################################## --]]
-- Import
GroupTemplateSubframe = ImpExpContent.GroupTemplateSubframe
GroupTemplateSubframe.ImportEditBox = ZN.MultiLineEditBox("GRPTemplateImportEditBox", GroupTemplateSubframe, "BOTTOM", GroupTemplateSubframe, "BOTTOM", 660, 180, 0, 15, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
GroupTemplateSubframe.ImportNameTextBox = ZN.SingleLineEditBox("ImportNameTextBox", GroupTemplateSubframe, "BOTTOMLEFT", GroupTemplateSubframe.ImportEditBox, "TOPLEFT", 400, 30, 0, 10, 10, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Enter Template Name", "LEFT")
GroupTemplateSubframe.TemplateImportButton = ZN.CreateGenericButton("TemplateImportButton", GroupTemplateSubframe, "BOTTOMRIGHT", GroupTemplateSubframe.ImportEditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Import", "CENTER",true )

GroupTemplateSubframe.TemplateImportButton:SetScript("OnClick", function(self) 
  local newTemplateName = GroupTemplateSubframe.ImportNameTextBox:GetText()
  local encstr = GroupTemplateSubframe.ImportEditBox.editbox:GetText()
  local decstr = ZN:dec(encstr)

  if newTemplateName == "Enter Template Name" or newTemplateName == "" then
    UIErrorsFrame:AddMessage("Please Enter a Name for your Template", 0.8, 0.07, 0.2, 5.0)    
    return
  end
  if encstr == "" then
    UIErrorsFrame:AddMessage("You need to insert an import string", 0.8, 0.07, 0.2, 5.0)
    return
  end

  ZNotes.GroupTemplates[newTemplateName] = loadstring(decstr)()

  GroupTemplateSubframe.ImportEditBox.editbox:SetText("|cff"..ZN.Colors.itemUncommon.."Template successfully imported as|r |cff"..ZN.Colors.chatInstance.."'"..newTemplateName.."'|r")
end)
-- Export
GroupTemplateSubframe = ImpExpContent.GroupTemplateSubframe
GroupTemplateSubframe.ExportEditBox = ZN.MultiLineEditBox("GRPTemplateExportEditBox", GroupTemplateSubframe, "TOP", GroupTemplateSubframe, "TOP", 660, 180, 0, -65, 0, 0 ,12, ZN.Colors.ACTIVE, ZN.Colors.HD, nil, "", "LEFT")
GroupTemplateSubframe.TemplateSelectButton = ZN.CreateGenericButton("ZNGroupTemplateSelectButton", GroupTemplateSubframe, "BOTTOMLEFT", GroupTemplateSubframe.ExportEditBox, "TOPLEFT", 240, 30, 0, 10,10,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Select Group Template..", "LEFT",true )
GroupTemplateSubframe.TemplateSelectButton.doOnUpdate = true
GroupTemplateSubframe.TemplateSelectButton.OnUpdate = function(_,_,_,newValue) selectedTemplate = newValue end
GroupTemplateSubframe.TemplateExportButton = ZN.CreateGenericButton("TemplateExportButton", GroupTemplateSubframe, "BOTTOMRIGHT", GroupTemplateSubframe.ExportEditBox, "TOPRIGHT", 200, 30, 0, 10,0,0, 12, ZN.Colors.ACTIVE, ZN.Colors.SBButtonBG, nil, "Export", "CENTER",true )

GroupTemplateSubframe.TemplateSelectButton:SetScript("OnClick", function(self) ZN:CreateDropdown(self, ZN:getTableKeys(ZNotes.GroupTemplates), ZN:getTemplateTableWithoutCurrentOrder(ZNotes.GroupTemplates), 240, ZN.Colors.INACTIVE, "LEFT", 10) end)
GroupTemplateSubframe.TemplateExportButton:SetScript("OnClick", function(self) 
  if selectedTemplate == nil or selectedTemplate == "Select Group Template.." then
    ZN:Print("You need to select a Group Template")
    return
  end
  local str = ZN:serializeTable(ZNotes.GroupTemplates[selectedTemplate], nil, true) 
  
  GroupTemplateSubframe.ExportEditBox.editbox:SetText(ZN:enc(str)) 
end)